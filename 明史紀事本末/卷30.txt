英宗正統二年冬十月，雲南麓川宣慰司思任叛，侵南甸州。洪武中，麓川思倫發內附，授麓川宣慰。按思倫所居本麓川地，與緬接境，皆在金沙江之南，在元為平緬宣慰司，思倫不言麓川，蓋已據緬為己有。洪武中，大兵下雲南，改平緬為麓川平緬軍民宣慰司，麓川之名始見。至二十九年，平緬入貢，更立宣慰司，不相混一。未幾思倫叛，黔國公沐英討平之。其後失官，改孟養宣慰使，以刁氏代之。正統初，宣慰使刁賓玉弱不能輯諸夷，思倫發次子思任者狡獪踰父兄，差發金銀，不以時納，朝廷稍優容之。會緬甸危，思任侵有其地，遂欲盡復父所失故地，於是擁眾叛於麓川。先是，侵孟定、灣甸，大殺掠，雲南總兵黔國公沐晟以聞。至是復侵南甸州土官刁貢罕地，命沐晟遣官齎金牌信符，諭還所侵地，思任不奉詔。
三年冬十二月，思任侵掠騰衝、南甸，略取孟養地，刁賓玉奔永昌，死，無嗣。思任屠騰衝，據潞江，仍自稱曰「法」。「法」，滇王號也，中國遂訛為思任發雲。事聞，上遣刑部主事楊寧往諭之，不服。
四年春正月，命鎮守雲南黔國公沐晟、左都督方政、右都督沐昻率師討思任發，太監吳誠、曹吉祥監軍。兵至金齒，思任發遣其將緬簡斷江立柵而守，師不得渡。初，思任未叛時，刁賓玉嘗遣詣晟，晟兒畜之。至是晟遣指揮車琳等諭之降，思任佯許諾，晟信之，無渡江意。刑部主事楊寧曰：「不可。兵未加，稱降，此詐也。懼有後悔。」晟不從，檄寧督餉金齒。賊將緬簡數挑戰，政怒，造舟六十艘，欲渡江。晟不可，政不勝憤，夜獨率其麾下渡擊緬簡，走之，破賊柵。賊奔景罕寨，指揮唐清擊敗之，指揮高遠等又追敗之高黎共山下。共斬三千餘級，乘勝深入，逼思任上江。上江，賊重地也。遠攻疲甚，求援於晟。晟怒其違節制渡江，不遣。久之，以少兵往，至夾象石不進。政渡江追至空泥，知晟不力援己，賊伏兵四起，出象陣衝擊，乃遣其子瑛還曰：「若急歸，吾死分也。」遂策馬突陣死，軍殲焉。晟聞敗，適春暮，慮瘴發，遂焚江上積聚，倉卒奔還永昌。至楚雄，上遣使者責狀，仍以四萬五千人助之。晟懼罪，暴卒。思任發犯景東、孟定，殺大侯知州刁奉漢等，破孟賴諸寨，降孟達等長官司。
五月，以沐昻為左都督征南將軍，右都督吳亮為副將軍，馬翔、張榮為左右參將，進討思任發。昻上潞江之捷，陞賞有差。
五年春二月，沐昻討麓川，軍抵隴把，去賊巢甚近，右參將都督僉事張榮先令都指揮盧鉞擊賊，大敗。榮棄符驗軍器遁，昻等不能救。師還，敕責沐昻等，留昻鎮守，右都督吳亮、左參將馬翔俱逮下理。
秋七月，思任發屯孟羅，大掠，據者章硬寨。沐昻率都指揮方瑛、柳英等進克之，賊宵遁。威遠川土知州刁蓋罕戰威江，亦敗之。已而思任發遣流目陶孟、忙怕等入貢，禮部議減其饗賚，上曰：「彼來雖緩我師，而朕不逆詐。」遂齎而不宴，賜敕諭之。
六年春正月，命定西伯蔣貴為征蠻將軍，總兵討麓川思任發，以太監曹吉祥監督軍務，兵部尚書王驥提督軍務，侍郎徐晞督軍餉。初，雲南總兵沐晟等議麓川險遠，攻之非十二萬人不可。宜徵兵湖廣、川、貴，各委善戰指揮，分三道，灣甸、芒布、騰衝，刻期並進。上下廷議，英國公張輔等言分兵勢孤，彼或扼險邀我，非萬全計，宜擇大臣往雲南專征。會思任發遣使謝，刑部侍郎何文淵上言：「麓川之在南陲，彈丸耳！疆里不過數百，人民不滿萬餘，宜寬其天討。官軍於金齒，且耕且守。舜德格苗，不勞征伐，而稽首來王矣。」大學士楊士奇主其說。張輔謂思任發世職六十餘年，屢抗王師，釋此不誅，恐木邦、車里、八百、緬甸等覘視窺覬，示弱小夷，非策。上從之。遂命貴、驥先赴雲南，復以副總兵李安、參將宮聚領川、貴兵，副總兵劉聚、參將冉保領南京、湖廣兵，大發兵十五萬，轉餉半天下。驥薦太僕寺少卿李蕢、郎中侯璡、楊寧，主事蔣琳等為參謀。陛辭，上賜驥、貴等金兜鍪細鎧弓矢蟒衣以行。侍讀劉球上疏言：「麓川荒遠偏隅，即叛服不足為中國輕重。而脫歡、也先併吞諸部，侵擾邊境，議者釋豺狼攻犬豕，舍門庭之近，圖邊徼之遠，非計之得也。請罷麓川兵，專備西北。」不報。蓋王振專政，欲示威荒服也。
十一月，定西伯蔣貴、兵部尚書王驥等討麓川，大破之，思任發遁去。先是，思任發率眾三萬，至大侯州，欲攻景東、威遠，兵部郎中侯璡、都指揮馬讓、盧鉞擊之，驥等遂進至金齒。鎮康守陶孟、刁門俸乞降，令右參將冉保以五千人入據之，因其眾破昔剌寨，移攻孟通。王驥誓師分三道進取，參將冉保自緬甸趨孟定，會木邦、車里之師；驥同蔣貴中路，至騰衝；內官曹吉祥、副總兵劉聚等自下江、夾象石合攻，徑抵上江。上江者，賊砦所在也。攻二日不下，會天大風，驥命縱火焚柵，大破之，拔上江寨。賊千餘猶迎戰，官軍奮長戈蹴之，賊將刁放戛父子俱沒，刁招漢闔家自焚，生擒刁門項，先後斬五萬級。上江平，賊散走。大兵由夾象石、下江通高黎貢山道至騰衝，留副總兵李安戍之。王驥等取道南甸，至羅卜思莊，令指揮江洪等以八千人抵木籠山。思任發乘險以二萬人列七營相救，副總兵劉聚、參將宮聚分攻之，不下。驥、貴同奉御監蕭保自中路進，左右夾攻，敗之，斬數百餘級，乘勝至馬鞍山，破其象陣，死者十餘萬，麓川大震。
十二月，王驥等直搗巢穴。山周三十里，柵堅塹廣，其東南依江壁立。以三千人探之，賊象陣伏泥溝突起，敗之。賊又自永毛摩尼寨至馬鞍山，伺我後。令都指揮方瑛以六千人攻拔之。瑛，方政子也。而右參將冉保從東路合木邦、車里、大侯之兵，先後斬三千三百九十餘級。於是進攻麓川，積薪焚其柵，思任發挈妻子間道渡江走緬甸，焚溺數萬。驥等班師，敘平麓川功，進封蔣貴定西侯，王驥靖遠伯，以郎中侯璡、楊寧為侍郎，餘陞賞有差。
七年冬十月，復命定西侯蔣貴、靖遠伯王驥征麓川、緬甸。先是，思任發既敗走緬，大軍還，復出為寇。上謂驥曰：「卿為朕再行。」遂起兵如前，復命驥等往討之。
八年春二月，定西侯蔣貴、靖遠伯王驥軍至金齒，遣諭緬甸送思任發軍前。緬人佯諾，不遣。驥曰：「緬甸黨賊，不可不討也。」乃至騰衝，分為五營，與蔣貴及都督沐昻分道並進。木邦宣慰使統兵萬餘，駐於蠻江滸，覘我軍容。驥責以忠義，賜牛酒，遂感悅效死。緬人擁眾大至，蔣貴率兵蔽江而下，焚其舟數百艘，大戰一晝夜，賊潰，思任發復遁去，俘其妻子，班師。蔣貴起自行伍，屢立顯功，與士卒同甘苦。凡出征，衣糧器械不役一人。臨陣身先士卒，敵皆披靡，必手擊殺數十人。不知書。然貴為大將，拱手聽人指揮，無傲色，故所向成功。
九年春二月，王驥合木邦等諸部，進兵緬甸，累捷。緬人用大金縷船載思任發至江上覘我，復匿之。欲以麓川予木邦，孟養、戛里予緬甸，始獻思任發，詭以思任子思機發致仇為解。驥等乃縱兵搗思機發寨，俘其妻子及從賊九十餘人、象十一。事聞，上詔驥還京。然思機發尚竊據孟養，負固不服。
十年冬十二月，雲南千戶王政奉敕幣諭緬甸宣慰（男）〔使〕〈據《國榷》卷二十六改。〉卜剌浪馬哈省索思任發，未即遣。適晝晦二日，術者曰：「天兵至矣。」卜剌浪馬哈省懼，以思任發及妻孥部屬三十二人付政。思任發不食，垂死，政遂斬首，函獻京師。
十三年春三月，初，思機發復據孟養地為亂，屢諭不從。復命靖遠伯王驥提督軍務，都督宮聚為總兵，張軏、田禮為左右副總兵，方瑛、張銳為左右參將，率南京、雲南、湖廣、四川、貴州土漢軍十三萬討之。以孟養舊宣慰刁孟賓為嚮道，又敕木邦、緬甸、南甸、干崖、隴川宣慰使刁蓋發等，各輸兵餉。命戶部右侍郎焦宏督餉雲南。
十月，師抵金沙江，賊柵西岸以拒。驥造浮梁以渡，攻破之，乘勝進至孟養。賊歛眾據鬼哭山及芒崖山等寨，皆攻拔之，斬獲無算。貴州都指揮使洛宣、九谿衛指揮使翟亨皆戰死。思機竟失所在，或謂死於亂兵也。王師踰孟養至孟那。孟養在金沙江西，去麓川千餘里，諸部皆震怖，曰：「自古漢人無渡金沙江者，今王師至此，真天威也！」驥還兵，部落復擁思任子思祿為亂，攻銀起莽，敗之，復據孟養地。驥等慮師老，度賊不可滅，乃與思祿約，許以土目得部勒諸夷，居孟養如故。復與立石金沙江為界，誓曰：「石爛江枯，爾乃得渡。」思祿亦懼，聽命。乃班師，以捷聞，詔增驥祿，賜鐵券，子孫世襲伯爵。
