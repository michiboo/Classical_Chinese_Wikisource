
律曆中
夫曆者，紀陰陽之通變，極往數以知來，可以迎日授時，先天成務者也。然則懸象著明，莫大於二曜，氣序環複，無信於四時。日月相推而明生矣，寒暑迭進而歲成焉，遂能成天地之文，極乾坤之變。天數五，地數五，五位相乘而各有合。天數二十有五，地數三十，凡天地之數五十有五，所以成變化而行鬼神也。乾之策二百一十有六，坤之策一百四十有四，凡三百六十，以當期之日也。至乃陰陽迭用。剛柔相摩，四象既陳，八卦成列，此乃造文之元始，創曆之厥初者歟？洎乎炎帝分八節，軒轅建五部，少昊以鳳鳥司曆，顓頊以南正司天，陶唐則分命和仲，夏後乃備陳《鴻范》，湯武革命，咸率舊章。然文質既殊，正朔斯革，故天子置日官，諸侯有日禦，以和萬國，以協三辰。至於寒暑晦明之徵，陰陽生殺之數，啟閉升降之紀，消息盈虛之節，皆應躔次而不淫，遂得該浹生靈，堪輿天地，開物成務，致遠鉤深。周德既衰，史官廢職，疇人分散，禨祥莫理。秦兼天下，頗推五勝，自以獲水德之瑞，以十月為正。漢氏初興，多所未暇，百有餘載，猶行秦曆。至於孝武，改用夏正。時有古曆六家，學者疑其紕繆，劉向父子，咸加討論，班固因之，采以為志。光武中興，未能詳考。逮於永平之末，乃複改行四分，七十餘年，儀式方備。其後覆命劉洪、蔡邕，共修律曆，司馬彪用之以續《班史》。當塗受命，亦有史官，韓翊創之於前，楊偉繼之於後，咸遵劉洪之術，未及洪之深妙。中、左兩晉，迭有增損。至於西涼，亦為蔀法，事蹟糾紛，未能詳記。宋氏元嘉，何承天造曆，迄於齊末，相仍用之。梁武初興，因循齊舊，天監中年，方改行宋祖沖之《甲子元曆》。陳武受禪，亦無創改。後齊文宣，用宋景業曆。西魏入關，行李業興曆。逮於周武帝，乃有甄鸞造《甲寅元曆》，遂參用推步焉。大象之初，太史上士馬顯，又上《丙寅元曆》，便即行用。迄於開皇四年，乃改用張賓曆，十七年，複行張胄玄曆，至於義寧。今采梁天監以來五代損益之要，以著於篇雲。
梁初因齊，用宋《元嘉曆》。天監三年下詔定曆，員外散騎侍郎祖暅奏曰：「臣先在晉已來，世居此職。仰尋黃帝至今十二代，曆元不同，周天、斗分，疏密亦異，當代用之，各垂一法。宋大明中，臣先人考古法，以為正曆，垂之於後，事皆符驗，不可改張。」八年，暅又上疏論之。詔使太史令將匠道秀等，候新舊二曆氣朔、交會及七曜行度，起八年十一月，訖九年七月，新曆密，舊曆疏。暅乃奏稱：「史官今所用何承天曆，稍與天乖，緯緒參差，不可承案。被詔付靈台，與新曆對課疏密，前期百日，並又再申。始自去冬，終於今朔，得失之效，並已月別啟聞。夫七曜運行，理數深妙，一失其源，則歲積彌爽。所上脫可施用，宜在來正。」至九年正月，用祖沖之所造《甲子元曆》頒朔。至大同十年，制詔更造新曆，以甲子為元，六百一十九為章歲，一千五百三十六為日法，一百八十三年冬至差一度，月朔以遲疾定其小餘，有三大二小。未及施用而遭侯景亂，遂寢。
陳氏因梁，亦用祖沖之曆，更無所創改。後齊文宣受禪，命散騎侍郎宋景業葉圖讖，造《天保曆》。景業奏：依《握誠圖》及《元命包》，言齊受錄之期，當魏終之紀，得乘三十五以為蔀，應六百七十六以為章。」文宣大悅，乃施用之。期曆統曰：「上元甲子，至天保元年庚午，積十一萬五百六算外，章歲六百七十六，度法二萬三千六百六十，斗分五千七百八十七，曆餘十六萬二千二百六十一。」至後主武平七年，董峻、鄭元偉立議非之曰：「宋景業移閏於天正，退命於冬至交會之際，承二大之後，三月之交，妄減平分。臣案，景業學非探賾，識殊深解，有心改作，多依舊章，唯寫子換母，頗有變革，妄誕穿鑿，不會真理。乃使日之所在，差至八度，節氣後天，閏先一月。朔望虧食，既未能知其表裡，遲疾之曆步，又不可以傍通。妄設平分，虛退冬至，虛退則日數減於周年，平分妄設，故加時差於異日。五星見伏，有違二旬，遲疾逆留，或乖兩宿。軌褵之術，妄刻水旱。今上《甲寅元曆》，並以六百五十七為章，二萬二千三百三十八為蔀，五千四百六十一為斗分，甲寅歲甲子日為元紀。」又有廣平人劉孝孫、張孟賓二人，同知曆事。孟賓受業於張子信，並棄舊事，更制新法。又有趙道嚴，准晷影之長短，定日行之進退，更造盈縮，以求虧食之期。劉孝孫以百一十九為章，八千四十七為紀，九百六十六為歲餘，甲子為上元，命日度起虛中。張孟賓以六百一十九為章，四萬八1千九百為紀，九百四十八為日法，萬四千九百四十五為斗分。元紀共命，法略旨遠。日月五星，並從斗十一起。盈縮轉度，陰陽分至，與漏刻相符，共日影俱合，循轉無窮。上拒春秋，下盡天統，日月虧食及五星所在，以二人新法考之，無有不合。其年，訖幹敬禮及曆家豫刻日食疏密。六月戊申朔，太陽虧，劉孝孫言食於卯時，張孟賓言食於甲時，鄭元偉、董峻言食於辰時，宋景業言食於巳時。至日食，乃於卯甲之間，其言皆不能中。爭論未定，遂屬國亡。
西魏入關，尚行李業興《正光曆》法。至周明帝武成元年，始詔有司造周曆。於是露門學士明克讓、麟趾學士庾季才及諸日者，采祖暅舊議，通簡南北之術。自斯已後，頗觀其謬，故周、齊並時，而曆差一日。克讓儒者，不處日官，以其書下於太史。及武帝時，甄鸞造《天和曆》。上元甲寅至天和元年丙戌，積八十七萬五千七百九十二算外，章歲三百九十一，蔀法二萬三千四百六十，日法二十九萬一百六十，朔餘十五萬三千九百九十一，斗分五千七百三十一，會餘九萬三千五百一十六，曆餘一十六萬八百三十，冬至斗十五度，參用推步。終於宣政元年。大象元年，太史上士馬顯等，又上《丙寅元曆》，抗表奏曰：
臣案九章五紀之旨，三統四分之說，咸以節宣發斂，考詳晷緯，布政授時，以為皇極者也。而乾維難測，斗憲易差，盈縮之期致舛，咎徵之道斯應。甯止蛇或乘龍，水能沴火，因亦玉羊掩曜，金雞喪精。王化關以盛衰，有國由其隆替，曆之時義，於斯為重。自炎漢已還，迄於有魏，運經四代，事涉千年，日禦天官，不乏於世，命元班朔，互有沿改。驗近則疊璧應辰，經遠則連珠失次，義難循舊，其在茲乎？大周受圖膺錄，牢籠萬古，時夏乘殷，斟酌前代，曆變壬子，元用甲寅。高祖武皇帝索隱探賾，盡性窮理，以為此曆雖行，未臻其妙，爰降詔旨，博訪時賢，並敕太史上士馬顯等，更事刊定，務得其宜。然術藝之士，各封異見，凡所上曆，合有八家，精粗踳駁，未能盡善。去年冬，孝宣皇帝乃詔臣等，監考疏密，更令同造。謹案史曹舊簿及諸家法數，棄短取長，共定今術。開元發統，肇自丙寅，至於兩曜虧食，五星伏見，參校積時，最為精密。庶鐵炭輕重，無失寒燠之宜，灰箭飛浮，不爽陰陽之度。上元丙寅至大象元年己亥，積四萬一千五百五十四算上。日法五萬三千五百六十三，亦名蔀會法。章歲四百四十八，斗分三千一百六十七，蔀法一萬二千九百九十二。章中為章會法。日法五萬三千五百六十三，曆餘二萬九千六百九十三，會日百七十三，會餘一萬六千六百一十九，冬至日在斗十二度。小周餘、盈縮積，其曆術別推入蔀會，分用陽率四百九十九，陰率九。每十二月下各有日月蝕轉分，推步加減之，乃為定蝕大小餘，而求加時之正。
其術施行。時高祖作輔，方行禪代之事，欲以符命曜於天下。道士張賓，揣知上意，自雲玄相，洞曉星曆，因盛言有代謝之徵，又稱上儀錶非人臣相。由是大被知遇，恆在幕府。及受禪之初，擢賓為華州刺史，使與儀同劉暉、驃騎將軍董琳、索盧縣公祐、前太史上士馬顯、太學博士鄭元偉、前保章上士任悅、開府掾張撤、前蕩邊將軍張膺之、校書郎衡洪建、太史監候粟相、太史司曆郭翟、劉宜、兼算學博士張乾敘、門下參人王君瑞、荀隆伯等，議造新曆，仍令太常卿盧賁監之。賓等依何承天法，微加增損，四年二月撰成奏上。高祖下詔曰：「張賓等存心算數，通洽古今，每有陳聞，多所啟沃。畢功表奏，具已披覽。使後月複育，不出前晦之宵，前月之餘，罕留後朔之旦。減朓就朒，懸殊舊准。月行表裡，厥途乃異，日交弗食，由循陽道。驗時轉算，不越纖毫，逖德前修，斯秘未啟。有一於此，實為精密，宜頒天下，依法施用。」
張賓所造曆法，其要：
以上元甲子已來，至開皇四年歲在甲辰，積四百一十二萬九千一，算上。
蔀法，一十萬二千九百六十。
章歲，四百二十九。
章月，五千三百六。
通月，五百三十七萬二千二百九。
日法，一十八萬一千九百二十。
斗分，二萬五千六十三。
會月，一千二百九十七。
會率，二百二十一。
會數，一百一十半。
會分，一十一億八千七百二十五萬八千一百八十九。
會日法，四千二十萬四千三百二十。
會日，百七十三。
餘，五萬六千一百四十三。
小分，一百一十。
交法，五億一千二百一十萬四千八百。
交分法，二千八百一十五。
陰陽曆，一十三。
餘，十一萬二百六十三。
小分，二千三百二十八。
朔差，二。
餘，五萬七千九百二十一。
小分，九百七十四。
蝕限，一十二。
餘，八萬一千三百三。
小分，四百三十三半。
定差，四萬四千五百四十八。
周日，二十七。
餘，一十萬八百五十九。亦名少大法
木精曰歲星，合率四千一百六萬三千八百八十九。
火精曰熒惑，合率八千二十九萬七千九百二十六。
土精曰鎮星，合率三千八百九十二萬五千四百一十三。
金精曰太白，合率六千一十一萬九千六百五十五。
水精曰辰星，合率一千一百九十三萬一千一百二十五。
張賓所創之曆既行，劉孝孫與冀州秀才劉焯，並稱其失，言學無師法，刻食不中，所駁凡有六條：其一雲，何承天不知分閏之有失，而用十九年之七閏。其二雲，賓等不解宿度之差改，而冬至之日守常度。其三雲，連珠合璧，七曜須同，乃以五星別元。其四雲，賓等唯知日氣餘分恰盡而為立元之法，不知日月不合，不成朔旦冬至。其五雲，賓等但守立元定法，不須明有進退。其六雲，賓等唯識轉加大餘二十九以為朔，不解取日月合會准以為定。此六事微妙，歷數大綱，聖賢之通術，而暉未曉此，實管窺之謂也。若乃驗影定氣，何氏所優，賓等推測，去之彌遠。合朔順天，何氏所劣，賓等依據，循彼迷蹤。蓋是失其菁華，得其糠粃者也。又雲，魏明帝時，有尚書郎楊偉，修《景初曆》，乃上表立義，駁難前非，雲：「加時後天，食不在朔。」然觀楊偉之意，故以食朔為真，未能詳之而制其法。至宋元嘉中，何承天著曆，其上表雲：「月行不定，或有遲疾，合朔月食，不在朔望，亦非曆之意也。」然承天本意，欲立合朔之術，遭皮延宗飾非致難，故事不得行。至後魏獻帝時，有龍宜弟複修延興之曆，又上表雲：「日食不在朔，而習之不廢，據《春秋》書食，乃天之驗朔也。」此三人者，前代善曆，皆有其意，未正其書。但歷數所重，唯在朔氣。朔為朝會之首，氣為生長之端，朔有告餼之文，氣有郊迎之典，故孔子命曆而定朔旦冬至，以為將來之範。今孝孫曆法，並按明文，以月行遲疾定其合朔，欲今食必在朔，不在晦、二之日也。縱使頻月一小、三大，得天之統。大抵其法有三，今列之雲。
第一，勘日食證恆在朔。
引《詩》雲：「十月之交，朔日辛卯，日有食之。」今以甲子元曆術推算，符合不差。《春秋經》書日食三十五。二十七日食，經書有朔，推與甲子元曆不差。八食，經書並無朔字。《左氏傳》雲：「不書朔，官失之也。」《公羊傳》雲：「不言朔者，食二日也。「《穀梁傳》雲：「不言朔者，食晦也。」今以甲子元曆推算，俱是朔日。丘明受經夫子，於理尤詳，《公羊》、《穀梁》皆臆說也。
《春秋左氏》隱公三年二月己巳，日有食之。推合己巳朔
莊公十八年春三月，日有食之。推合壬子朔
僖公十二年三月庚午，日有食之。推合庚午朔
十五年夏五月，日有食之。推合癸未朔
襄公十五年秋八月丁巳，日有食之。推合丁巳朔
前、後漢及魏、晉四代所記日食，朔、晦及先晦，都合一百八十一，今以甲子元曆術推之，併合朔日而食。
前漢合有四十五食。三食並先晦一日，三十二食並皆晦日，十食並是朔日
後漢合有七十四食。三十七食並皆晦日，三十七食並皆朔日
魏合有十四食。四食並皆晦日，十食並皆朔日
晉合有四十八食。二十五食並皆晦日，二十三食並皆朔日
第二，勘度差變驗。
《尚書》雲：「日短星昴，以正仲冬。」即是唐堯之時，冬至之日，日在危宿，合昏之時，昴正午。案《竹書紀年》，堯元年丙子。今以甲子元曆術推算得合堯時冬至之日，合昏之時，昴星正午。《漢書》武帝太初元年丁丑歲，落下閎等考定太初曆冬至之日，日在牽牛初。今以甲子元曆術算，即得斗末牛初矣。晉時有薑岌，又以月食驗於日度，知冬至之日日在斗十七度。宋文帝元嘉十年癸酉歲，何承天考驗乾度，亦知冬至之日日在斗十七度。雖言冬至後上三日，前後通融，只合在斗十七度。但堯年漢日，所在既殊，唯晉及宋，所在未改，故知其度，理有變差。至今大隋甲辰之歲，考定歷數象，以稽天道，知冬至之日日在斗十三度。
第三，勘氣影長驗。
《春秋緯命曆序》雲：「魯僖公五年正月壬子朔旦冬至。」今以甲子元曆術推算，得合不差。《宋書》元嘉十年，何承天以土圭測影，知冬至已差三日。詔使付外考驗，起元嘉十三年為始，畢元嘉二十年，八年之中，冬至之日恆與影長之日差校三日。今以甲子元曆術推算，但是冬至之日恆與影長之符合不差。詳之如左：
十三年丙子，
天正十八日曆注冬至，
十五日影長，
即是今曆冬至日。
十四年丁丑，
天正二十九日曆注冬至，
二十六日影長，
即是今曆冬至日。
十五年戊寅，
天正十一日曆注冬至，
陰，無影可驗，
今曆八日冬至。
十六年己卯，
天正二十一日曆注冬至，
十八日影長，
即是今曆冬至日。
十七年庚辰，
天正二日曆注冬至，
十月二十九日影長，
即是今曆冬至日。
十八年辛巳，
天正十三日曆注冬至，
十日影長，
即是今曆冬至日。
十九年壬午，
天正二十九日曆注冬至，
陰，無影可驗，
今曆二十二日冬至。
二十年癸未，
天正六日曆注冬至，
三日影長，
即是今曆冬至日。
於時新曆初頒，賓有寵於高祖，劉暉附會之，被升為太史令。二人協議，共短孝孫，言其非毀天曆，率意迂怪，焯又妄相扶證，惑亂時人。孝孫、焯等，竟以他事斥罷。後賓死，孝孫為掖縣丞，委官入京，又上，前後為劉暉所詰，事寢不行。仍留孝孫直太史，累年不調，寓宿觀台。乃抱其書，弟子輿櫬，來詣闕下，伏而慟哭。執法拘以奏之，高祖異焉，以問國子祭酒何妥。妥言其善，即日擢授大都督，遣與賓曆比校短長。先是信都人張胄玄，以算術直太史，久未知名。至是與孝孫共短賓曆，異論鋒起，久之不定。至十四年七月，上令參問日食事。楊素等奏：「太史凡奏日食二十有五，唯一晦三朔，依克而食，尚不得其時，又不知所起，他皆無驗。胄玄所克，前後妙衷，時起分數，合如符契。孝孫所克，驗亦過半。」於是高祖引孝孫、胄玄等，親自勞徠。孝孫因請先斬劉暉，乃可定曆。高祖不懌，又罷之。俄而孝孫卒，楊素、牛弘等傷惜之，又薦胄玄。上召見之，胄玄因言日長影短之事，高祖大悅，賞賜甚厚，令與參定新術。劉焯聞胄玄進用，又增損孝孫曆法，更名《七曜新術》，以奏之。與胄玄之法，頗相乖爽，袁充與胄玄害之。焯又罷。至十七年，胄玄曆成，奏之。上付楊素等校其短長。劉暉與國子助教王頍等執舊曆術，迭相駁難，與司曆劉宜援據古史影等，駁胄玄雲：
《命曆序》僖公五年天正壬子朔旦日至，《左氏傳》僖公五年正月辛亥朔日南至。張賓曆，天正壬子朔冬至，合《命曆序》，差《傳》一日。張胄玄曆，天正壬子朔，合《命曆序》，差《傳》一日；三日甲寅冬至，差《命曆序》二日，差《傳》三日。成公十二年，《命曆序》天正辛卯朔旦日至。張賓曆，天正辛卯朔冬至，合《命曆序》。張胄玄曆，天正辛卯朔，合《命曆序》；二日壬辰冬至，差《命曆序》一日。昭公二十年，《春秋左氏傳》二月己丑朔日南至，准《命曆序》庚寅朔旦日至。張賓曆，天正庚寅朔冬至，併合《命曆序》，差《傳》一日。張胄玄曆，天正庚寅朔，合《命曆序》，差《傳》一日；二日辛卯冬至，差《命曆序》一日，差《傳》二日。宜案《命曆序》及《春秋左氏傳》，並閏餘盡之歲，皆須朔旦冬至。若依《命曆序》勘《春秋》三十七食，合處至多；若依《左傳》，合者至少，是以知《傳》為錯。今張胄玄信情置閏，《命曆序》及《傳》氣朔並差。又宋元嘉冬至影有七，張賓曆合者五，差者二，亦在前一日。張胄玄曆合者三，差者四，在後一日。元嘉十二年十一月甲寅朔，十五日戊辰冬至，日影長。張賓曆合戊辰冬至，張胄玄曆己巳冬至，差後一日。十三年十一月己酉朔，二十六日甲戌冬至，日影長。張賓曆癸酉冬至，差前一日，張胄玄曆合甲戌冬至。十五年十一月丁卯朔，十八日甲申冬至，日影長。二曆併合甲申冬至。十六年十一月辛酉朔，二十九日己丑冬至，日影長。張賓曆合己丑冬至，張胄玄曆庚寅冬至，差後一日。十七年十一月乙酉朔，十日甲午冬至，日影長。張賓曆合甲午冬至，張胄玄曆乙未冬至，差後一日。十八年十一月己卯朔，二十一日己亥冬至，日影長。張賓曆合己亥冬至，張胄玄曆庚子冬至，差後一日。十九年十一月癸卯朔，三日乙巳冬至，影長。張賓曆甲辰冬至，差前一日，張胄玄曆合乙巳冬至。
又周從天和元年丙戌至開皇十五年乙卯，合得冬夏至日影一十四。張賓曆合得者十，差者四，三差前一日，一差後一日。張胄玄曆合者五，差者九，八差後一日，一差前一日。天和二年十一月戊戌朔，三日庚子冬至，日影長。張賓曆合庚子冬至，張胄玄曆辛丑冬至，差後一日。三年十一月壬辰朔，十四日乙巳冬至，日影長。張賓曆合乙巳冬至，張胄玄曆丙午冬至，差後一日。建德元年十一月己亥朔，二十九日丁卯冬至，日影長。張賓曆丙寅冬至，差前一日，張胄玄曆合丁卯冬至。二年五月丙寅朔，三日戊辰夏至，日影短。張賓曆己巳夏至，差後一日，張胄玄曆庚午夏至，差後二日。三年十一月戊午朔，二十日丁丑冬至，日影長。張賓曆合丁丑冬至，張胄玄曆戊寅冬至，差後一日。六年十一月庚午朔，二十三日壬辰冬至，日影長。張賓曆合壬辰冬至，張胄玄曆癸巳冬至，差後一日。宣政元年十一月甲午朔，五日戊戌冬至，日影長。兩曆併合戊戌冬至。開皇四年十一月己未朔，十一日己巳冬至，日影長。張賓曆合己巳冬至，張胄玄曆庚午冬至，差後一日。五年十一月甲寅朔，二十二日乙亥冬至，日影長。張賓曆甲戌冬至，差前一日，張胄玄曆合庚辰冬至。七年五月乙亥朔，九日癸未夏至，日影短。張賓曆壬午夏至，差前一日，張胄玄曆合癸未夏至。十一月壬申朔，十四日乙酉冬至，日影長。張賓曆合乙酉冬至，張胄玄曆丙戌冬至，差後一日。十一年十一月己卯朔，二十八日丙午冬至，日影長。張賓曆合丙午冬至，張胄玄曆丁未冬至，差後一日。十四年十一月辛酉朔旦冬至。張賓曆合十一月辛酉朔旦冬至，張胄玄曆十一月辛酉朔，二日壬戌冬至，差後一日。建德四年四月大、乙酉朔，三十日甲寅，月晨見東方。張賓曆四月大、乙酉朔，三十日甲寅，月晨見東方，張胄玄曆四月小、乙酉朔，五月大，甲寅朔，月晨見東方。宜案影極長為冬至，影極短為夏至，二至自古史分可勘者二十四，其二十一有影，三有至日無影。見行曆合一十八，差者六。旅騎尉張胄玄曆合者八，差者一十六，二差後二日，一十四差後一日。又開皇四年，在洛州測冬至影，與京師二處，進退絲毫不差。周天和已來案驗並在後。更檢得建德四年，晦朔東見；張胄玄曆，五月朔日，月晨見東方。今十七年，張賓曆閏七月，張胄玄曆閏五月。又審至以定閏，胄玄曆至既不當，故知置閏必乖。見行曆四月、五月頻大，張胄玄曆九月、十月頻大，為胄玄朔弱，頻大在後晨，故朔日殘月晨見東方。
宜又案開皇四年十二月十五日癸卯，依曆月行在鬼三度，時加酉，月在卯上，食十五分之九，虧起西北。今伺候，一更一籌起食東北角，十五分之十，至四籌還生，至二更一籌複滿。五年六月三十日，依曆太陽虧，日在七星六度，加時在午少強上，食十五分之一半強，虧起西南角。今伺候，日乃在午後六刻上始食，虧起西北角，十五分之六，至未後一刻還生，至五刻複滿。六年六月十五日，依曆太陰虧，加時酉，在卯上，食十五分之九半弱，虧起西南，當其時陰雲不見月。至辰巳，雲裡見月，已食三分之二，虧從東北，既還雲合。至巳午間稍生，至午後，雲裡暫見，已複滿。十月三十日丁丑，依曆太陽虧，日在斗九度，時加在辰少弱上，食十五分之九強，虧起東北角。今候所見，日出山一丈，辰二刻始食，虧起正西，食三分之二，辰後二刻始生，入巳時三刻上複滿。十年三月十六日癸卯，依曆月行在氐七度，時加戌，月在辰太半上，食十五分之七半強，虧起東北。今候，月初出卯南，帶半食，出至辰初三分，可食二分許，漸生，辰未已複滿。見行曆九月十六日庚子，月行在胃四度，時加醜，月在未半強上，食十分之三半強，虧起正東。今伺候，月以午後二刻，食起正東，須臾如南，至未正上，食南畔五分之四，漸生，入申一刻半複滿。十二年七月十五日己未，依曆月行在室七度，時加戌，月在辰太強上，食十五分之十二半弱，虧起西北。今伺候，一更三籌起西北上，食准三分之二強，與曆注同。十三年七月十六日，依曆月在申半強上，食十五分之半弱，虧起西南。十五日夜，從四更候月，五更一籌起東北上，食半強，入雲不見。十四年七月一日，依歷時加巳弱上，食十五分之十二半強。至未後三刻，日乃食，虧起西北，食半許，入雲不見，食頃暫見，猶未複生，因即雲鄣。十五年十一月十六日庚午，依曆月行在井十七度，時加亥，月在巳半上，食十五分之九半強，虧西北。其夜一更四籌後，月在辰上起食，虧東南，至二更三籌，月在巳上，食三分之二許，漸生，至三更一籌，月在丙上，複滿。十六年十一月十六日乙丑，依曆月行在井十七度，時加醜，月在未太弱上，食十五分之十二半弱，虧起東南。十五日夜伺候，至三更一籌，月在丙上，雲裡見，已食十五分之三許，虧起正東，至丁上，食既，後從東南生，至四更三籌，月在未末，複滿。而胄玄不能盡中。
迭相駁難，高祖惑焉，逾時不決。會通事舍人顏慜楚上書雲：「漢落下閎改《顓頊曆》作《太初曆》，雲後八百歲，此曆差一日。」語在胄玄傳。高祖欲神其事，遂下詔曰：「朕應運受圖，君臨萬宇，思欲興複聖教，恢弘令典，上順天道，下授人時，搜揚海內，廣延術士。旅騎尉張胄玄，理思沉敏，術藝宏深，懷道白首，來上曆法。令與太史舊曆，並加勘審。仰觀玄象，參驗璿璣，胄玄歷數與七曜符合，太史所行，乃多疏舛，群官博議，咸以胄玄為密。太史令劉暉，司曆郭翟、劉宜，驍騎尉任悅，往經修造，致此乖謬。通直散騎常侍、領太史令庾季才，太史丞邢俊，司曆郭遠，曆博士蘇粲，曆助教傅俊、成珍等，既是職司，須審疏密。遂虛行此曆，無所發明。論暉等情狀，已合科罪，方共飾非護短，不從正法。季才等附下罔上，義實難容。」於是暉等四人，元造詐者，並除名；季才等六人，容隱奸慝，俱解見任。胄玄所造曆法，付有司施行。擢拜胄玄為員外散騎侍郎，領太史令。胄玄進袁充，互相引重，各擅一能，更為延譽。胄玄言充曆妙極前賢，充言胄玄曆術冠於今古。胄玄學祖沖之，兼傳其師法。自茲厥後，克食頗中。其開皇十七年所行曆術，命冬至起虛五度。後稍覺其疏，至大業四年劉焯卒後，乃敢改法，命起虛七度，諸法率更有增損，朔終義寧。今錄戊辰年所定曆術著之於此雲。
自甲子元至大業四年戊辰，百四十二萬七千六百四十四年，算外。
章歲，四百一十。
章閏，百五十一。
章月，五千七十一。
日法，千一百四十四。
月法，三萬三千七百八十三。
辰法，二百八十六。
歲分，一千五百五十七萬二千九百六十三。
度法，四萬二千六百四十。
沒分，五百一十九萬一千三百一十一
沒法，七萬四千五百二十一。
周天分，一千五百五十七萬四千四百六十六。
斗分，一萬八百六十六。
氣法，四十六萬九千四十。
氣時法，一萬六百六十。
周日，二十七。
日餘，一千四百一十三。
周通，七萬二百九。
周法，二千五百四十八。
推積月術：
置入元已來至所求年，以章月乘之，如章歲得一，為積月，餘為閏餘。閏餘三百九十七巳上，若冬至不在其月，加積月一
推月朔弦望術：
以月法乘積月，如法得一，為積日，餘為小餘。以六十去積日，餘為大餘，命以甲子算外，為所求年天正月朔日。天正月者，建子月也，今為去年十一月。凡朔小餘五百四十七巳上，其月大。
加大餘七，小餘四百三十七太；凡四分一為少，二為半，三為太。小餘滿日法去之，從大餘；滿六十去之，命如前，為上弦日。又加，得望、下弦、後月朔。朔餘滿五百三十七，其月大，減者小餘。
推二十四氣術：
以月法乘閏餘，又以章歲乘朔小餘，加之，如氣法得一，為日，命朔算外，為冬至日。不盡者，以十一約之，為日分。
求次氣：加日十五，日分九千三百一十五，小分一；小分滿八從日分一，日分滿度法從日一；如月大小去之，日不滿月，算外，為次氣日。其月無中氣者，為閏。
求朔望入氣盈縮術：
以入氣日算乘損益率，如十五得一，餘八已上，從一；以損益盈縮數為定盈縮。其入氣日十五算者，如十六得一，餘半法已上亦從一，以下皆準此。
推土王術：
加分至日二十七，日分一萬六千七百六十七，小分九；小分滿四十從日分一，滿去如前，即分至後土始王日。
推沒日術：
其氣有小分者，以八乘日分，內小分，又以十五乘之，以減沒分；無小分者，以百二十乘日分，以減之；滿沒法為日，不盡為日分，以其氣去朔日加之，去、命如前。
求次沒：加日六十九，日分四萬九千三百七十二；日分滿沒法，從日，去、命如前。
推入遲疾曆術：
以周通去朔積日，餘以周法乘之，滿周通又去之，餘滿周法得一日，餘為日餘，即所求年天正朔算外夜半入曆日及餘。
求次月：大月加二日，小月加一日，日餘皆千一百三十五，滿周日及日餘去之。
求次日：加一，滿、去如前。
求朔望加時入曆術：
以四十九乘朔小餘，滿二十二得一為日餘，不盡為小分，以加夜半入曆日及餘分。
求次月：加日一，餘二千四百八十六，小分二十一，滿、去如前，即次月入曆日及餘。
求望：加日十四日，餘千九百四十九，小分二十一半，滿、去如前，為望入曆日及餘。
推朔望加時定日及小餘術：
以入曆日餘乘所入曆日損益率，以損益盈縮積分，如差法而一，為定積分。如差法乃與入氣定盈縮，皆以盈減、縮加本朔望小餘；不足減者，加日法乃減之，加時在往日；加之，滿日法者去之，則在來日；餘為定小餘。無食者不須氣盈縮。
角十二度亢九度氐十五度房五度心五度尾十八度箕十一度
東方七宿七十五度
斗二十六度牛八度女十二度虛十度危十七度室十六度壁九度
北方七宿九十八度
奎十六度婁十二度胃十四度昴十一度畢十六度觜二度參九度
西方七宿八十度
井三十三度鬼四度柳十五度星七度張十八度翼十八度軫十七度
南方七宿百一十二度
推日度術：
置入元至所求年，以歲分乘之，為通實，滿周天分去之，餘如度法而一，為積度，不盡為度分。命度以虛七度宿次去之，經斗去其分，度不滿宿，算外，即所求年天正冬至日所在度及分。以冬至去朔日以減分度數，分不足減者，減度一，加度法，乃減之，命如前，即天正朔前夜半日所在度及分。須求朔共度者，用去定用日數減之，俟後所須。
求次月：大月加度三十，小月加度二十九，宿次去之，經斗去其分。
求次日：加度一，去、命如前。
求朔望加時日所在度術：
各以定小餘乘章歲，滿十一為度分，以加其前夜半度分，滿之去如前。凡朔加時日月同度
求轉分：以千四十約度分，不盡為小分。
求望加時月所在度術：
置望加時日所在度及分，加度一百八十二，轉分二十五，小分七百五十三；小分滿千四十從轉分一，轉分滿四十一從度；去、命如前，經斗去轉分十，小分四百六十六。
求月行遲疾日轉定分術：
以夜半入曆日餘乘轉差，滿周法得一為變差，以進加、退減日轉分為定分。
推朔望夜半月定度術：
以定小餘乘所入曆日轉定分，滿日法得一為分，分滿四十一為度，各以減加時月所在度，即各其前夜半定度。
求次日：以日轉定分加轉分，滿四十一從度，去、命如前；朔日不用前加。
推五星術：
木數，千七百萬八千三百三十二四分
火數，三千三百二十五萬六千二十六。
土數，千六百一十二萬一千七百六十七。
金數，二千四百八十九萬八千四百一十七。
水數，四百九十四萬一千九十八。
木終日，三百九十八，日分，三萬七千六百一十二四分。
火終日，七百七十九，日分，三萬九千四百六十六。
土終日，三百七十八，日分，三千八百四十七。
金終日，五百八十三，日分，三萬九千二百九十七。晨見伏，三百二十七日，分同；夕見伏，二百五十六日。
水終日，百一十五，日分，三萬七千四百九十八。晨見伏，六十三日，分同；夕見伏，五十二日。
求星見術：
置通實，各以數去之，餘以減數，其餘如度法得一為日，不盡為日分，即所求年天正冬至後晨平見日及分。其金、水，以夕見伏日去之，得者餘為夕平見日及分。
求平見見月日：置冬至去朔日數及分，各以冬至後日數及分加之，分滿度法從日，起天正月，依大小去之，不滿月者為去朔日，命日算外，即星見所在月日及分。
求後見：各以終日及分加之，滿去如前。其金、水各以晨夕加之，滿去如前，加晨得夕，加夕得晨。
木：平見在春分前者，以三千三百四十乘去大寒後十日數，以加平見分，滿法去之，以為定見日及分。立秋後者，以四千二百乘去寒露日，加之，滿同前。春分至清明均加四日，後至立夏五日，以後至芒種加六日，均至立秋。小雪前者，以七千四百乘去寒露日數，以減平見日分；冬至後者，以八千三百乘去大寒後十日數，以減之；小雪至冬至均減八日，為定日數。初見伏去日各十四度。
火：平見在雨水前，以二萬六千八百八十乘去大寒日數；在立夏後，以萬三千四百四十乘去立秋日數，以加見日分，滿去如前；雨水至立夏，均加二十九日。小雪前，以萬一千五百八十乘去處暑日數；冬至後，以三萬四千三百八十乘去大寒日數，滿去如前，以減之；小雪至冬至，均減二十五日。初見伏去日各十七度。
土：平見在處暑前，以萬二千三百七十乘去大暑日數；白露後，以八千三百四十乘去霜降日數，以加見日分，滿去如前；處暑至白露均加九日。小寒前，以四千九百八十乘去霜降日數，小寒至立春均減九日，立春後減八日，啟蟄後去七，氣別去一，至穀雨去三，夏至後十日去一，至大暑去盡。初見伏去日各十七度。
金：晨平見，在立春前者，以四千一百二十乘去小寒日數小滿後，以四千一百二十乘去夏至日數，以加見日分，滿去如前立春至小滿均加三日。立秋前，以四千一百二十乘去小暑日數，小雪後以四千一百二十乘去冬至日數，滿去如前，以減之，立秋至小雪均減三日。夕平見，在啟蟄前，以六千三百九十乘去小雪日數。清明後，以六千二百九十乘去芒種日數，滿去如前，以減之，啟蟄至清明均減九日。處暑前，以六千二百九十乘去夏至日數；寒露後，以六千二百九十乘去大雪日數；以加之，處暑至寒露均加九日。初見伏去日各十一度。
水：晨平見，在雨水後、立夏前者，應見不見。啟蟄至雨水，去日十八度外、四十六度內，晨有木、火、土、金一星已上者，見；無者不見。立夏至小滿，去日度如前，晨有木、火、土、金一星已上者，見；無者亦不見。從霜降至小雪加一日，冬至至小寒減四日，立春至雨水減三日。冬至前，一去三，二去二，三去一。夕平見，在處暑後、霜降前者，應見不見。立秋至處暑，夕有星，去日如前者，見；無者亦不見。霜降至立冬，夕有星，去日如前者，見；無者亦不見。從穀雨至夏至，減二日。初見伏去日各十七度。
行五星法：
置星定見之前夜半日所在宿度算及分，各以定見日分加其分，滿度法從度。又以星初見去日度數，晨減、夕加之，滿去如前，即星初見所在度及分。
求次日：各加一日所行度及分，有小分者，各日數為母，小分滿其母去從分，分滿度法從度。其行有益疾遲者，副置一日行分，各以其分疾益遲損之。留者因前，退則減之，伏不注度，順行出斗去其分，退行入斗先加分。訖，皆以千四十約分，為大分，以四十一為母。
木：初見，順，日行萬六百一十八分，日益遲六十分，一百一十四日行十九度、萬三千八百三十二分而留。二十六日乃退，日六千一百一分，八十四日退十二度、八百四分。又留二十五日、三萬七千六百一十二分、小分四，乃順。初日行三千八百三十七分，日益疾六十分，百一十四日行十九度、萬三千七百一十八分而伏。
土：初見，順，日行三千八百一十四分，八十三日行七度、萬八千八十二分而留。三十八日乃退，日二千五百六十三分，百日退六度、四百六十分。又留三十七日、三千八百四十七分乃順，日三千八百一十三分，八十三日行七度萬七千九百九十九分，如初乃伏。
火：初見已後各如其法：
見在雨水前，以見去小寒日數，小滿後，以去大暑日數；三約之，所得減日為定日；雨水至小滿，均去二十日為定日。已前皆前疾日數及度數。各計冬至後日數，依損益之，為定日數及度數。以度法乘定度，如定日得一，即平行一日分，不盡為小分。大寒至立秋差行，餘平行。處暑至白露，皆去定日，定度六。白露至寒露，初日行半度，四十日行二十度，餘日及餘度續同前。置日數減一，以三十乘之，加平行一日分，為初日分。差行者，日益遲六十分，各盡其日度而遲。初日行二萬六百分，日益遲百分，六十日行二十四度、三萬五千六百四十分其前疾去度六者，此遲初日加四千二百六十四分，六十日行三十度，分同。而留。十三日前去日者，分、日於二留，奇縱後留。乃退，日萬二千八十二分，六十日退十七度、四十分。又留，十二日三萬九千四百六十六分。又順，遲，初日行萬四千七百分，日益疾百分，六十日行二十四度，分同前，此遲在立秋至秋分加一日，行分四千二百六十四，六十日行四十度，分同前。而後疾。
後遲加六度者，此後疾去度為定度，已前皆後疾日數及度數。其在立夏至，小暑，日行半度，盡六十日，行三十度。小暑至立秋，盡四十日，行二十度。計餘日及度，從前法。前法皆平行。求行分亦如前。各盡其日度而伏。
金：晨初見，乃退，日半度，十日退五度而留。九日乃順，遲，差行，先遲日益五百分，四十日行三十度。小暑前以去芒種日數，十日減一度；立冬後以去大雪日數，十日減一度；小暑至立冬，均減三度為定度。大雪至芒種不加減。求初日，以三十乘度法，四十得一為平分。又以三十九乘二百五十，以減平分為初日行分。平行，日一度，十五日行十五度。小寒後十日，益日度各一，至雨水二十一日，行二十一度。均至春分後十日減一，至小滿，複十五日行十五度。其後六日減一，至處暑，日及度皆盡。至霜降後，四日益一，至冬至複十五日行十五度疾，百七十日行二百四度。前順遲減度者，計減數益此度為定度。求一日行度分者，以百七十日日一度以減定度，餘乘度法，如百七十得一，為一日平行度分。晨伏東方。夕初見，順，疾，百七十日行二百四度。夏至前，以見去小滿日數，六日加一度；小暑後，以去立秋日數，六日加一度，夏至至小暑均加五度，為定度。白露至清明，差行，先疾日益遲百分。清明至白露，平行，求一日平行同，晨疾求差行，以五十乘百六十九，加之，為初日行度分。平行，日一度，十五日行十五度。冬至後十日減日度各一，至啟蟄九日行九度。均至夏至後五日益一，至大暑複十五日行十五度。均至立秋後六日益一，至寒露二十五日行二十五度。後六日減一，至大雪複十五日行十五度，均至冬至。順，遲，差行，先疾，日益五百分，四十日行三十度。前加度者，此依數減之，求初日行分。如晨遲，唯減者為加之。又留，九日乃退，日半度，十日退五度，而夕伏西方。
水：晨初見，留六日。順，遲，日行萬六百六十分，四日行一度。大寒至雨水不須此遲行。平行，日一度，十日行十度。大寒後二日，去日度各一，盡二十日，日及度俱盡。疾，日行一度三萬八千三百七十六分，十日行十九度，前無遲行者，減此分萬二千七百九十二分，十日行十六度。晨伏東方。夕初見，順，疾，日行一度三萬八千三百七十六分，十日行十九度。小暑至白露減萬二千七百九十二分，十日行十六度。平行，日一度，十日行十度。大暑後二日，去日度各一，盡二十日，日及度俱盡。遲，日行萬六百六十分，四日行一度。疾減萬二千七百九十二分者，不須此遲。行又留六日，夕伏西方。
推交會術：
會通，千六十四萬六千七百二十九。
朔差，九十萬七千五十七。
望差，四十五萬三千五百二十八半。
單數，五百三十二萬三千三百六十四半。
時法，三萬二千六百四。
望數，五百七十七萬六千八百九十三。
外限，四百八十六萬九千八百三十六。
內限，千一十九萬三千二百半。
中限，五百六十四萬九千四百四半。
次限，千三十二萬六百八十九。
推入交法：
以會通去積月，餘以朔望差乘之，滿會通又去之，餘為所求年天正朔入交餘。
求望，望數加之，滿、去如前。
求次月，以朔差加之，滿、去如前。
推交道內外及先後去交術：
其朔望在啟蟄前，以一千三百八十乘去小寒日數；在穀雨後，以乘去芒種日數，為氣差以加之，啟蟄至穀雨均加六萬三千六百；滿會通去之，餘為定餘。其小寒至春分，立夏至芒種，朔值盈二時已下，皆半氣差而加之；二時已上，皆不加。朔入交餘如望差、望數已下，中限已上，有星伏，木、土去見十日外，火去見四十日外，金、晨伏去見二十二日外。有一星者不加氣差。朔望在白露前者，以九百乘去小暑日數；在立冬後者，以千七百七十乘去大雪日數，以減之；白露至立冬均減五萬五千，不足減者，加會通乃減之，餘為定餘。朔入交餘如外限、內限已上，單數次限已下有星伏，如前者，不減氣差。定餘不滿單數者，為在外；滿去之，餘在內。其餘如望差已下、外限已上，望則月食；在內者，朔則日食。其餘如望差已下者，即為去先交餘；如外限已上者，以減單數，餘為去後交餘。如時法得一，然為去交時數。
推月食加時術：
置食定日小餘，三之，如辰法得一辰，命以子算外，即所在辰。不盡為時餘，四之，如法，無所得為辰初，一為少，二為半，三為太。又不盡者，三之，如法，得一為強，以並少為少強，並半為半強，並太為太強；得二強者為少弱，並少為半弱，並半為太弱，並太為辰末。此加時謂食時月在沖也。
推日食加時術：
置食定日小餘，秋三月，內道，去交八時已上，加二十四，十二時以加四十八；春三月，內道，去交七時已上，加二十四。乃以三乘之，如辰法得一辰，以命子算外，即所在辰。不盡為時餘。副置時餘，仲辰不滿半辰，減半辰，已上去半辰；季辰者直加半辰；孟辰者減辰法，餘加半辰為差率。
又，置去交時數，三已下加三，六已下加二，九已下加一，九已上依數，十二已上從十二；以乘差率，如十四得一為時差。子半至卯半、午半至酉半，以加時餘；卯半至午半、酉半至子半，以減時餘。加之，滿辰法去之，進一辰，減之若不足，退一辰，餘為定時餘。乃如月食法，子午卯酉為仲，辰戌醜未為季，寅申巳亥為孟。日出前入後各二時外，不注日食。三乘氣時法得一，命子算外為時。
求外道日食法：
去交一時內者，食。夏去交二時內，加時在南方三辰者，食。若去分至十二時內，去交六時內者，亦食。若去春分三日內，後交二時內，秋分三日內，先交二時內者，亦食。先交二時內，值盈二時外，及後交二時內，值縮二時外，亦食。諸去交三時內，星伏如前者，食。
求內道日不食法：
加時南方三辰，五月朔先交十三時外，六月朔後交十三時外，不食。啟蟄至穀雨，先交十三時外，值縮加時在未以西者，不食。處暑至霜降，後交十三時外，值盈加時在巳以東者，不食。
求月食分：
春後交、秋先交、冬後交，皆去不食餘一時，不足去者，食既。餘以三萬二百三十五為法，得一為不食分。不盡者，半法已上為半強，已下為半弱，以減十五，餘為食分。
推日食分術：
在秋分前者，以去夏至日數乘二千，以減去交餘，餘為不食餘；不足減者，反減十八萬四千，餘為不食餘。亦減望差為定法。其後交值縮，並不減望差，直以望差為定法。在啟蟄後者，以去夏至日數乘千五百以減之；秋分至啟蟄，均減十八萬四千，不足減者，如前；大寒至小滿，去後交五時外，皆去不食餘一時。時差減者，先交減之，後交加之，不足減者食既；值加，先交加之，後交減之。不足減者食。
求所起：內道西北，虧東北；外道西南，虧東南。十三分以上，正左起。虧皆據甚時，月則行上起。
求日出入所在術：
以所入氣辰刻及分，與後氣辰刻及分相減，餘乘入氣日算，如十五得一，以損益所入氣，依刻及分為定刻。
隋書總目
隋書 隋書總目
隋書卷一十八志第十三
律曆下
開皇二十年，袁充奏日長影短，高祖因以曆事付皇太子，遣更研詳著日長之候。太子征天下曆算之士，咸集於東宮。劉焯以太子新立，複增修其書，名曰《皇極曆》，駁正胄玄之短。太子頗嘉之，未獲考驗。焯為太學博士，負其精博，志解胄玄之印，官不滿意，又稱疾罷歸。至仁壽四年，焯言胄玄之誤於皇太子：
其一曰，張胄玄所上見行曆，日月交食，星度見留，雖未盡善，得其大較，官至五品，誠無所愧。但因人成事，非其實錄，就而討論，違舛甚眾。
其二曰，胄玄弦望晦朔，違古且疏，氣節閏候，乖天爽命。時不從子半，晨前別為後日。日躔莫悟緩急，月逡妄為兩種，月度之轉，輒遺盈縮，交會之際，意造氣差。七曜之行，不循其道，月星之度，行無出入，應黃反赤，當近更遠，虧食乖准，陰陽無法。星端不協，珠璧不同，盈縮失倫，行度愆序。去極晷漏，應有而無，食分先後，彌為煩碎。測今不審，考古莫通，立術之疏，不可紀極。今隨事糾駁，凡五百三十六條。
其三曰，胄玄以開皇五年，與李文琮於張賓曆行之後，本州貢舉，即齎所造曆擬以上應。其曆在鄉陽流布，散寫甚多，今所見行，與焯前曆不異。玄前擬獻，年將六十，非是忽迫倉卒始為，何故至京未幾，即變同焯曆，與舊懸殊？焯作於前，玄獻於後，舍己從人，異同暗會。且孝孫因焯，胄玄後附孝孫，曆術之文，又皆是孝孫所作，則元本偷竊，事甚分明。恐胄玄推諱，故依前曆為駁，凡七十五條，並前曆本俱上。
其四曰，玄為史官，自奏虧食，前後所上，多與曆違，今算其乖舛有一十三事。又前與太史令劉暉等校其疏密五十四事，雲五十三條新。計後為曆應密於舊，見用算推，更疏於本。今糾發並前，凡四十四條。
其五曰，胄玄於曆，未為精通。然孝孫初造，皆有意，徵天推步，事必出生，不是空文，徒為臆斷。
其六曰，焯以開皇三年，奉敕修造，顧循記注，自許精微，秦漢以來，無所與讓。尋聖人之跡，悟曩哲之心，測七曜之行，得三光之度，正諸氣朔，成一曆象，會通今古，符允經傳，稽於庶類，信而有徵。胄玄所違，焯法皆合，胄玄所闕，今則盡有，隱括始終，謂為總備。
仍上啟曰：「自木鐸寢聲，緒言成燼，群生蕩析，諸夏沸騰，曲技雲浮，疇官雨絕，曆紀廢壞，千百年矣。焯以庸鄙，謬荷甄擢，專精藝業，耽玩數象，自力群儒之下，冀睹聖人之意。開皇之初，奉敕修撰，性不諧物，功不克終，猶被胄玄竊為己法，未能盡妙，協時多爽，屍官亂日，實玷皇猷。請征胄玄答，驗其長短。」
焯又造曆家同異，名曰《稽極》。大業元年，著作郎王邵、諸葛潁二人，因入侍宴，言劉焯善曆，推步精審，證引陽明。帝曰：「知之久矣。」仍下其書與胄玄參校。胄玄駁難雲：「焯曆有歲率、月率，而立定朔，月有三大、三小。案歲率、月率者，平朔之章歲、章月也。以平朔之率而求定朔，值三小者，猶以減三五為十四；值三大者，增三五為十六也。校其理實，並非十五之正。故張衡及何承天創有此意，為難者執數以校其率，率皆自敗，故不克成。今焯為定朔，則須除其平率，然後為可。」互相駁難，是非不決，焯又罷歸。
四年，駕幸汾陽宮，太史奏曰：「日食無效。」帝召焯，欲行其曆。袁允方幸於帝，左右胄玄，共排焯曆，又會焯死，曆竟不行。術士鹹稱其妙，故錄其術雲。甲子元，距大隋仁壽四年甲子積一百萬八千八百四十算。
歲率，六百七十六。
月率，八千三百六十一。
朔日法，千二百四十二。
朔實，三萬六千六百七十七。
旬周，六十。
朔辰，百三半。
日干元，五十二。
日限，十一。
盈泛，十六。
虧總，十七。
推經朔術：
置入元距所求年，月率乘之，如歲率而一，為積月，不滿為閏衰。朔實乘積月，滿朔日法得一，為積日，不滿為朔餘。旬周去積日，不盡為日，即所求年天正經朔日及餘。
求上下弦、望：加經朔日七、餘四百七十五小，即上弦經日及餘。又加得望、下弦及後月朔。就徑求望者，加日十四、餘九百五十半；下弦加日二十二、餘百八十三大；後月朔加日二十九，餘六百五十九。每月加閏衰二十大，即各其月閏衰也。
凡月建子為天正，建醜為地正，建寅為人正。即以人正為正月，統求所起，本於天正。若建歲曆從正月始，氣、候、月、星，所值節度，雖有前卻，並亦隨之。其前地正為十二月，天正為十一月，並諸氣度皆屬往年。其日之初，亦從星起，晨前多少，俱歸昨日。若氣在夜半之後，量影以後日為正。諸因加者，各以其餘減法，殘者為全餘。若所因之餘滿全餘以上，皆增全一而加之，減其全餘；即因餘少於全餘者，不增全加，皆得所求。分度亦爾。凡日不全為餘，積以成餘者曰秒；度不全為分，積以成分者曰篾；其有不成秒曰麼，不成篾曰麼。其分、餘、秒、篾，皆一為小，二為半，三為大，四為全，加滿全者從一。其三分者，一為少，二為太。若加者，秒篾成法，從分餘。分餘滿法從日度一，日度有所滿，則從去之。而日命以日辰者，滿旬周則亦除；命有連分、餘、秒、篾者，亦隨全而從去。其日度雖滿，而分秒不滿者，未可從去，仍依本數。若減者，秒篾不足，減分餘一，加法而減之；分餘不足減者，加所從去或前日度乃減之。即其名有總，而日度全及分餘共者，須相加除，當皆連全及分餘共加除之。若須相乘，有分餘者，母必通全內子，乘訖報除。或分餘相並，母不同者，子乘而並之。母相乘為法，其並，滿法從一為全，此即齊同之也。既除為分餘而有不成，若例有秒篾，法乘而又法除，得秒篾數。已為秒篾及正有分餘，而所不成不復須者，須過半從一，無半棄之。若分餘其母不等，須變相通，以彼所法之母乘此分餘，而此母除之，得彼所須之子。所有秒篾者，亦法乘，不滿此母，又除而得其數。麼麼亦然。其所除去而有不盡全，則謂之不盡，亦曰不如。其不成全，全乃為不滿分、餘、秒、篾，更曰不成。凡以數相減，而有小及半、太須相加減，同於分餘法者，皆以其母三四除其氣度日法，以半及太、大本率二三乘之，少、小即須因所除之數隨其分餘而加減焉。秋分後春分前為盈泛，春分後秋分前為虧總，須取其數。泛總為名，指用其時，春分為主，虧日分後，盈日分前。凡所不見，皆放於此。
氣日法，四萬六千六百四十四。
歲數，千七百三萬六千四百六十六半。
度准，三百三十八。
約率，九。
氣辰，三千八百八十七。
餘通，八百九十七。
秒法，四十八。
麼法，五。
推氣術：
半閏衰乘朔實，又度准乘朔餘，加之，如約率而一，所得滿氣日法為去經朔日，不滿為氣餘。以去經朔日，即天正月冬至恆日定餘，乃加夜數之半者，減日一，滿者因前，皆為定日。命日甲子算外，即定冬至日。其餘如半氣辰千九百四十三半以下者，為氣加子半後也；過以上，先加此數，乃氣辰而一，命以辰算外，即氣所在辰。十二辰外，為子初以後餘也。又十二乘辰餘：
四為小太，亦曰少；五為半步；六為半；
七為半太；八為大少，亦曰太；九為太；
十為大太；十一為窮辰少。
其又不成法者，半以上為進，以下為退。退以配前為強，進以配後為弱。即初不成一而有退者，謂之沾辰；初成十一而有進者，謂之窮辰。未旦其名有重者，則於間可以加之，命辰通用其餘，辨日分辰而判諸日。因別亦皆準此。因冬至有減日者，還加之。每加日十五、餘萬一百九十二、秒三十七，即各次氣恆日及餘。諸月齊其閏衰，如求冬至法，亦即其月中氣恆日去經朔數。其求後月節氣恆日，如次之求前節者減之。
推每日遲速數術：
見求所在氣陟降率，並後氣率半之，以日限乘而泛總除，得氣末率。又日限乘二率相減之殘，泛總除，為總差。其總差亦日限乘而泛總除，為別差。率前少者，以總差減末率，為初率，乃別差加之；前多者，即以總差加末率，皆為氣初日陟降數。以別差前多者日減，前少者日加初數，得每日數。所曆推定氣日隨算其數，陟加、降減其遲速，為各遲速數。其後氣無同率及有數同者，皆因前末，以末數為初率，加總差為末率，及差漸加初率，為每日數，通計其秒，調而禦之。
求月朔弦望應平會日所入遲速：各置其經餘為辰，以入氣辰減之，乃日限乘日，日內辰為入限，以乘其氣前多之末率，前少之初率，日限而一，為總率。其前多者，入限減泛總之殘，乘總差，泛總而一，為入差，並於總差，入限乘，倍日限除，加以總率；前少者，入限自乘再乘別差，日限自乘，倍而除，亦加總率，皆為總數。乃以陟加、降減其氣遲速數為定，即速加、遲減其經餘，各其月平會日所入遲速定日及餘。
求每日所入先後：各置其氣躔衰與衰總，皆以餘通乘之，所乃躔衰如陟降率；衰總如遲速數，亦如求遲速法，即得每所入先後及定數。
求定氣：其每日所入先後數即為氣餘，其所曆日皆以先加之，以後減之，隨算其日，通准其餘，滿一恆氣，即為二至後一氣之數。以加二氣，如法用別其日而命之。又算其次，每相加命，各得其定氣日及餘也。亦以其先後已通者，先減後加其恆氣，即次氣定日及餘。亦因別其日，命以甲子，各得所求。
求土王：距四立各四氣外所入先後加減，滿二十二日、餘八千一百五十四、秒十、麼二。除所滿日外，即土始王日。
求侯日：定氣即初候日也。三除恆氣，各為平候日。餘亦以所入先後數為氣餘，所曆之日皆以先加、後減，隨計其日，通准其餘，每滿其平，以加氣日而命之，即得次候日。亦算其次，每相加命，又得末候及次氣日。
倍夜半之漏，得夜刻也。以減百刻，不盡為晝刻。每減晝刻五，以加夜刻，即其晝為日見、夜為不見刻數。刻分以百為母。
求日出入辰刻：十二除百刻，得辰刻數，為法。半不見刻以半辰加之，為日出實，又加日出見刻，為日入實。如法而一，命子算外，即所在辰，不滿法，為刻及分。
求辰前餘數：氣、朔日法乘夜半刻，百而一，即其餘也。
求每日刻差：每氣准為十五日，全刻二百二十五為法。其二至各前後於二分，而數因相加減，間皆六氣；各盡於四立，為三氣。至與前日為一，乃每日增太；又各二氣，每日增少；其末之氣，每日增少之小，而末六日，不加而裁焉。二望至前後一氣之末日，終於十少；二氣初日，稍增為十二半，終於二十太，三氣初日，二十一，終於三十少；四立初日，三十一，終於三十五太；五氣亦少增，初日三十六太，終四十一少；末氣初日，四十一少，終於四十二。每氣前後累算其數，又百八十乘為實，各泛總乘法而除，得其刻差。隨而加減夜刻而半之，各得入氣夜定刻。其分後十五日外，累算盡日，乃副置之，百八十乘，虧總除，為其所因數。以減上位，不盡為所加也。不全日者，隨辰率之。
求晨去中星：加周度一，各昏去中星減之，不盡為晨去度。
求每日度差：准日因增加裁，累算所得，百四十三之，四百而一，亦百八十乘，泛總除，為度差數。滿轉法為度，隨日加減，各得所求。分後氣間，亦求准外與前求刻，至前加減，皆因日數逆算求之。亦可因至向背其刻，冬減夏加，而度冬加夏減。若至前，以入氣減氣間，不盡者，因後氣而反之，以不盡日累算乘除所定，從後氣而逆以加減，皆得其數。此但略校其總，若精存於《稽極》雲。
轉終日，二十七；餘，千二百五十五。
終法，二千二百六十三。
終實，六萬二千三百五十六。
終全餘，千八。
轉法，五十二。
篾法，八百九十七。
閏限，六百七十六。
推入轉術：終實去積日，不盡，以終法乘而又去，不如終實者，滿終法得一日，不滿為餘，即其年天正經朔夜半入轉日及餘。
求次日：加一日，每日滿轉終則去之，其二十八日者加全餘為夜半入初日餘。
求弦望：皆因朔加其經日，各得夜半所入日餘。
求次月：加大月二日，小月一日，皆及全餘，亦其夜半所入。
求經辰所入朔弦望：經餘變從轉，不成為秒，加其夜半所入，皆其辰入日及餘。因朔辰所入，每加日七、餘八百六十五、秒千一百六十大，秒滿日法成餘，亦得上弦。望、下弦、次朔經辰所入徑求者，加望日十四、餘千七百三十一、秒千七十九半，下弦日二十二、餘三百三十四、秒九百九十八小，次朔日一、餘二千二百八、秒九百一十七。亦朔望各增日一，減其全餘，望五百三十一、秒百六十二半，朔五十四、秒三百二十五。
求月平應會日所入：以月朔弦望會日所入遲速定數，亦變從轉餘，乃速加、遲減其經辰所入餘，即各平會所入日餘。
推朔弦望定日術：
各以月平會所入之日加減限，限並後限而半之，為通率；又二限相減，為限衰。前多者，以入餘減終法，殘乘限衰，終法而一，並於限衰而半之；前少者，半入餘乘限衰，亦終法而一，減限衰。皆加通率，入餘乘之，日法而一，所得為平會加減限數。其限數又別從轉餘為變餘，朓減、朒加本入餘。限前多者，朓以減與未減，朒以加與未加，皆減終法，並而半之，以乘限衰；前少者，亦朓朒各並二入餘，半之，以乘限衰；皆終法而一，加於通率，變餘乘之，日法而一。所得以朓減、朒加限數，加減朓朒積而定朓朒。乃朓減、朒加其平會日所入餘，滿若不足進退之，即朔弦望定日及餘。不滿晨前數者，借減日算，命甲子算外，各其日也。不減與減，朔日立算與後月同。若俱無立算者，月大，其定朔算後加所借減算。閏衰限滿閏限，定朔無中氣者為閏，滿之前後，在分前若近春分後、秋分前，而或月有二中者，皆量置其朔，不必依定。其後無同限者，亦因前多以通率數為半衰而減之，二前少，即為通率。其加減變餘進退日者，分為一日，隨餘初末如法求之，所得並以加減限數。凡分餘秒篾，事非因舊，文不著母者，皆十為法。若法當求數，用相加減，而更不過通遠，率少數微者，則不須算。其入七日餘二千一十一，十四日餘千七百五十九，二十一日餘千五百七，二十八日始終餘以下為初數，各減終法以上為末數。其初末數皆加減相返，其要各為九分，初則七日八分，十四日七分，二十一日六分，二十八日五分；末則七日一分，十四日二分，二十一日三分，二十八日四分。雖初稍弱而末微強，餘差止一，理勢兼舉，皆今有轉差，各隨其數。若恆算所求，七日與二十一日得初衰數，而末初加隱而不顯，且數與平行正等。亦初末有數而恆算所無，其十四日、二十八日既初末數存，而虛衰亦顯，其數當去，恆法不見。
求朔弦望之辰所加：
定餘半朔辰五十一大以下，為加子過；以上，加此數，乃朔辰而一，亦命以子，十二算外，又加子初。以後其求入辰強弱，如氣。
求入辰法度：
度法，四萬六千六百四十四。
周數，千七百三萬七千七十六。
周分，萬二千一十六。
轉，十三。
篾，三百五十五。
周差，六百九半。
在日謂之餘通，在度謂之篾法，亦氣為日法、為度法，隨事名異，其數本同。女末接虛，謂之周分。變周從轉，謂之轉。晨昏所距日在黃道中，準度赤道計之。
斗二十六牛八女十二虛十危十七室十六壁九
北方玄武七宿，九十八度。
奎十六婁十二胃十四昴十一畢十六觜二參九
西方白虎七宿，八十度。
井三十三鬼四柳十五星七張十八翼十八軫十七
南方硃雀七宿，百一十二度。
角十二亢九氐十五房五心五尾十八箕十一
東方蒼龍七宿，七十五度。
前皆赤道度，其數常定，紘帶天中，儀極攸准。
推黃道術：
准冬至所在為赤道度，後於赤道四度為限。初數九十七，每限增一，以終百七。其三度少弱，平。乃初限百九，亦每限增一，終百一十九，春分所在。因百一十九每限損一，又終百九。亦三度少弱，平。乃初限百七，每限損一，終九十七，夏至所在。又加冬至後法，得秋分、冬至所在數。各以數乘其限度，百八而一，累而總之，即皆黃道度也。度有分者，前後輩之，宿有前卻，度亦依體，數逐差遷，道不常定，准令為度，見步天行，歲久差多，隨術而變。
斗二十四牛七女十一半虛十危十七室十七壁十
北方九十六度半。
奎十七婁十三胃十五昴十一畢十五半觜二參九
西方八十二度半。
井三十鬼四柳十四半星七張十七翼十九軫十八
南方一百九度半。
角十三亢十氐十六房五心五尾十七箕十半
東方七十六度半。
前皆黃道度，步日所行。月與五星出入，循此。
推月道所行度術：
准交定前後所在度半之，亦於赤道四度為限，初十一，每限損一，以終於一。其三度強，平。乃初限數一，每限增一，亦終十一，為交所在。即因十一，每限損一，以終於一。亦三度強，平。又初限數一，每限增一，終於十一，複至交半，返前表裡。仍因十一增損，如道得後交及交半數。各積其數，百八十而一，即道所行每與黃道差數。其月在表，半後交前，損減增加；交後半前，損加增減於黃道。其月在裡，各返之，即得月道所行度。其限未盡四度，以所直行數乖入度，四而一。若月在黃道度，增損於黃道之表裡，不正當於其極，可每日准去黃道度，增損於黃道，而計去赤道之遠近，准上黃道之率以求之，遁伏相消，朓朒互補，則可知也。積交差多，隨交為正。其五星先候，在月表裡出入之漸，又格以黃儀，准求其限。若不可推明者，依黃道命度。
推日度術：
置入元距所求年歲數乘之，為積實，周數去之，不盡者，滿度法得積度，不滿為分。以冬至餘減分；命積度以黃道起於虛一宿次除之，不滿宿算外，即所求年天正冬至夜半日所在度及分。
求年天正定朔度：
以定朔日至冬至每日所入先後餘為分，日為度，加分以減冬至度，即天正定朔夜半日在所度分。亦去朔日乘衰總已通者，以至前定氣除之，又如上求差加以並去朔日乃減度，亦即天正定朔日所在度。皆日為度，餘為分。其所入先後及衰總用增損者，皆分前增、分後損其平日之度。
求次日：
每日所入先後分增損度，以加定朔度，得夜半。
求弦望：
去定朔每日所入分，累而增損去定朔日，乃加定朔度，亦得其夜半。
求次月：
曆算大月三十日，小月二十九日，每日所入先後分增損其月，以加前朔度，即各夜半所在至虛去周分。
求朔弦望辰所加：
各以度准乘定餘，約率而一，為平分。又定餘乘其日所入先後分，日法而一，乃增損其平分，以加其夜半，即各辰所加。其分皆篾法約之，為轉分，不成為篾。凡朔辰所加者，皆為合朔日月同度。
推月而與日同度術：
各以朔平會加減限數加減朓朒，為平會朓朒。以加減定朔，度准乘，約率除，以加減定朔辰所加日度，即平會辰日所在。又平會餘乘度准，約率除，減其辰所在，為平會夜半日所在。乃以四百六十四半乘平會餘，亦以周差乘，朔實除，從之，以減夜半日所在，即月平會夜半所在。三十七半乘平會餘，增其所減，以加減半，得月平會辰平行度。五百二乘朓棵，亦以周差乘，朔實除而從之，朓減、朒加其平行，即月定朔辰所在度，而與日同。若即以平會朓朒所得分加減平會辰所在，亦得同度。
求月弦望定辰度：
各置其弦望辰所加日度及分，加上弦度九十一，轉分十六，篾三百一十三；望度百八十二，轉分三十二，篾六百二十六；下弦度二百七十三，轉分四十九，篾四十二，皆至虛，去轉周求之。
定朔夜半入轉：
經朔夜半所入准於定朔日有增損者，亦以一日加減之，否者因經朔為定。
其因定求朔次日、弦望、次月夜半者，如於經月法為之。
推月轉日定分術：
以夜半入轉餘乘逡差，終法而一，為見差。以息加、消減其日逡分，為月每日所行逡定分。
求次日：
各以逡定分加轉分，滿轉法從度，皆其夜半。因日轉若各加定日，皆得朔、弦望夜半月所在定度。其就辰加以求夜半，各以半逡差減逡分，消者，定餘乘差，終法除，並差而半之；息者，半定餘以乘差，終法而一。皆加所減，乃以定餘乘之，日法而一，各減辰所加度，亦得其夜半度。因夜半亦如此求逡分，以加之，亦得辰所加度。諸轉可初以逡分及差為篾，而求其次，皆訖，乃除為轉分。因經朔夜半求定辰度者，以定辰去經朔夜半減，而求其增損數，乃以數求逡定分，加減其夜半，亦各定辰度。
求月晨昏度：
如前氣與所求每日夜漏之半，以逡定分乘之，百而一，為晨分；減逡定分，為昏分。除為轉度，望前以昏，後以晨，加夜半定度，得所在。
求晨昏中星：
各以度數加夜半定度，即中星度。其朔、弦、望，以百刻乘定餘，滿日法得一刻，即各定辰近入刻數。皆減其夜半漏，不盡為晨，初刻不滿者屬昨日。
複月，五千四百五十八。
交月，二千七百二十九。
交率，四百六十五。
交數，五千九百二十三。
交法，七百三十五萬六千三百六十六。
會法，五十七萬七千五百三十。
交複日，二十七。餘，二百六十三。秒，三千四百三十五。
交日，十三。餘，七百五十二。秒，四千六百七十九。
交限，日，十二。餘，五百五十五。秒，四百七十三半。
望差，日，一。餘，百九十七。秒，四千二百五半。
朔差，日，二。餘，三百九十五。秒，二千四百八十八。
會限，百五十八。餘，六百七十六。秒，五十半。
會日，百七十三。餘，三百八十四。秒，二百八十三。
推月行入交表裡術：
置入元積月，複月去之，不盡。交率乘而複去，不如複月者，滿交月去之，為在裡數；不滿為在表數，即所求年天正經入交表裡數。
求次月：
以交率加之，滿交月去之，前表者在裡，前裡者在表。
推月入交日術：
以朔實乘表裡數，為交實；滿交法為日，不滿者交數而一，為餘，不成為秒，命日算外，即其經朔月平入交日餘。
求望：以望差加之，滿交日去之，則月在表裡與朔同；不滿者與朔返。其月食者，先交與當月朔，後交與月朔表裡同。
求次月：朔差加月朔所入，滿交日去之，表裡與前月返；不滿者，與前月同。
求經朔望入交常日：
以月入氣朔望平會日遲速定數，速加、遲減其平入交日餘，為經交常日及餘。
求定朔望入交定日：
以交率乘定朓朒，交數而一，所得以朓減、朒加常日餘，即定朔望所入定日及餘。其去交如望差以下、交限以上者月食，月在裡者日食。
推日入會日術：
會法除交實為日，不滿者，如交率為餘，不成為秒，命日算外，即經朔日入平會日及餘。
求望：加望日及餘，次月加經朔，其表裡皆準入交。
求入會常日：以交數乘月入氣朔望所平會日遲速定數，交率而一，以速加、遲減其入平會日餘，即所入常日餘。亦以定朓朒，而朓減、朒加其常日餘，即日定朔望所入會日及餘。皆滿會日去之，其朔望去會，如望以下、會限以上者，亦月食；月日道表在日道裡則日食。
求月定朔望入交定日夜半：
交率乘定餘，交數而一，以減定朔望所入定日餘，即其夜半所定入。
求次日：
以每日遲速數，分前增、分後損定朔所入定日餘，以加其日，各得所入定日及餘。
求次月：
加定朔，大月二日，小月一日，皆餘九百七十八，秒二千四百八十八。各以一月遲速數，分前增、分後損其所加，為定。其入七日，餘九百九十七，秒二千三百三十九半以下者，進；其入此以上，盡全餘二百四十四，秒三千五百八十三半者，退。其入十四日，如交餘及秒以下者，退；其入此以上，盡全餘四百八十九，秒千二百四十四者，進而複也。其要為五分，初則七日四分，十四日三分；末則七日後一分，十四日後二分，雖初強末弱，衰率有檢。
求月入交去日道：皆同其數，以交餘為秒積，以後衰並去交衰，半之，為通數。進則秒積減衰法，以乘衰，交法除，而並衰以半之；退者，半秒積以乘衰，交法而一；皆加通數，秒積乘，交法除，所得以進退衰積，十而一為度，不滿者求其強弱，則月去日道數。月朔望入交，如限以上，減交日，殘為去後交數；如望差以下即為去先交數。有全日同為餘，各朔辰而一，得去交辰。其月在日道裡，日應食而有不食者；月日道表在日不應食而亦有食者。
推應食不食術：
朔先後在夏至十日內，去交十二辰少；二十日內，十二辰半；一月內，十二辰大；閏四月、六月，十三辰以上，加南方三辰。若朔在夏至二十日內，去交十三辰，以加辰申半以南四辰；閏四月、六月，亦加四辰；穀雨後、處暑前，加三辰；清明後、白露前，加巳半以西、未半以東二辰；春分後秋分前，加午一辰。皆去交十三辰半以上者，並或不食。
推不應食而食術：
朔在夏至前後一月內，去交二辰；四十六日內，一辰半，以加二辰；又一月內，亦一辰半，加三辰及加四辰，與四十六日內加三辰；穀雨後、處暑前，加巳少後、未太前；清明後、白露前，加二辰；春分後、秋分前，加一辰。皆去交半辰以下者，並得食。
推月食多少術：
望在分後，以去夏至氣數三之；其分前，又以去分氣數倍而加分後者；皆又以十加去交辰倍而並之，減其去交餘，為不食定餘。乃以減望差，殘者九十六而一，不滿者求其強弱，亦如氣辰法，以十五為限，命之，即各月食多少。
推日食多少術：
月在內者，朔在夏至前後二氣，加南二辰，增去交餘一辰太；加三辰，增一辰少，加四辰，增太。三氣內，加二辰，增一辰；加三辰，增太；加四辰，增少。四氣內，加二辰，增太；加三辰及五氣內，加二辰，增少。自外所加辰，立夏後、立秋前，依本其氣內加四辰，五氣內加三辰，六氣內加二辰。六氣內加二辰者，亦依平。自外所加之北諸辰，各依其去立夏、立秋、清明、白露數，隨其依平辰，辰北每辰以其數三分減去交餘；雨水後、霜降前，又半其去分日數，以加二分去二立之日，乃減去交餘；其在冬至前後，更以去霜降、雨水日數三除之，以加霜降雨水當氣所得之數；而減去交餘，皆為定不食餘。以減望差，乃如月食法。月在外者，其去交辰數，若日氣所系之限，止一而無等次者，加所去辰一，即為食數。若限有等次，加別系同者，隨所去交辰數而返其衰，以少為多，以多為少，亦加其一，以為食數。皆以十五為限，乃以命之，即各日之所食多少。
凡日食，月行黃道，體所映蔽，大較正交如累璧，漸減則有差，在內食分多，在外無損。雖外全而月下，內損而更高，交淺則閑遙；交深則相搏而不淹。因遙而蔽多，所觀之地又偏，所食之時亦別。月居外道，此不見虧，月外之人反以為食。交分正等，同在南方，冬損則多，夏虧乃少。假均冬夏，早晚又殊。處南辰體則高，居東西傍而下視有邪正。理不可一，由准率若實而違。古史所詳，事有紛互，今故推其梗概，求者知其指歸。苟地非於陽城，皆隨所而漸異。然月食以月行虛道，暗氣所沖，日有暗氣，天有虛道，正黃道常與日對，如鏡居下，魄耀見陰，名曰暗虛，奄月則食，故稱「當月月食，當星星亡。」雖夜半之辰，子午相對，正隔於地，虛道即虧。既月兆日光，當午更耀，時亦隔地，無廢稟明。諒以天光神妙，應感玄通，正當夜半，何害虧稟。月由虛道，表裡俱食。日之與月，體同勢等，校其食分，月盡為多，容或形差，微增虧數，疏而不漏，綱要克舉。
推日食所在辰術：
置定餘，倍日限，克減之，月在裡，三乘朔辰為法，除之，所得以艮巽坤乾為次。命艮算外，不滿法者半法減之，無可減者為前，所減之殘為後，前則因餘，後者減法，各為其率。乃以十加去交辰，三除之，以乘率，十四而一，為差。其朔所在氣二分前後一氣內，即為定差。近冬至，以去寒露、驚蟄，近夏至，以去清明、白露氣數，倍而三除去交辰，增之。近冬至，艮巽以加，坤乾以減；近夏至，艮巽以減，坤乾以加其差為定差。乃艮以坤加，巽以乾減定餘。月在外，直三除去交辰，以乘率，十四而一，亦為定差。艮坤以減，巽乾以加定餘，皆為食餘。如氣求入辰法，即日食所在辰及大小。其求辰刻，以辰克乘辰餘，朔辰而一，得刻及分。若食近朝夕者，以朔所入氣日之出入刻，校食所在，知食見否之少多所在辰，為正見。
推月食所在辰術：
三日阻減望定餘半。置望之所入氣日，不見刻，朔日法乘之，百而一，所得若食餘與之等、以下，又以此所得減朔日法，其殘食餘與之等、以上，為食正見數。其食餘亦朔辰而一，如求加辰所在。又如前求刻校之，月在沖辰食，日月食既有起訖晚早，亦或變常進退，皆於正見前後十二刻半候之。
推日月食起訖辰術：
准其食分十五分為率，全以下各為衰。十四分以上，以一為衰，以盡於五分。每因前衰每降一分，積衰增二，以加於前，以至三分。每積增四。二分每增四，二分增六，一分增十九，皆累算為各衰。三百為率，各衰減之，各以其殘乘朔日法，皆率而一，所得為食衰數。其率全，即以朔日法為衰數，以衰數加減食餘，其減者為起，加者為訖，數亦如氣。
求入辰法及求刻：以加減食所刻等，得起訖晚早之辰，與校正見多少之數。史書虧複起訖不同，今以其全一辰為率。
推日月食所起術：
月在內者，其正南，則起右上，虧左上。若正東，月自日上邪北而下。其在東南維前，東向望之，初不正，橫月高日下；乃月稍西北，日漸東南，過於維後，南向望之，月更北，日差西南；以至於午之後，亦南望之，月欹西北，日複東南。西南維後，西向而望，月為東北，日則西南。正西，自日北下邪虧，而亦後不正，橫月高日下。若食十二分以上，起右虧左。其正東，起上近虧下而北，午前則漸自上邪下。維西，起西北，虧東南。維北，起西南，虧東北；午後則稍從下傍下。維東，起西南，虧東北。維南，起西北，虧東南。在東則以上為東，在西則以下為西。
月在外者，其正南，起右下，虧左上。在正東，月自日南邪下而映。維北，則月微東南，日返西。維西南，日稍移東北，以至於午，月南日北，過午之後，月稍東南，日更西北。維北，月有西南，日複東北。正西，月自日下邪南而上。皆準此體以定起虧，隨其所處，每用不同。其月之所食，皆依日虧起，每隨類反之，皆與日食限同表裡，而與日返其逆順，上下過其分。
五星：
歲為木
熒惑為火
鎮為土
太白為金
辰為水
木數，千八百六十萬五千四百六十八。
伏半平，八十三萬六千八百四十八。
複日，三百九十八；餘，四萬一千一百五十六。
歲一，殘日，三十三；餘，二萬九千七百四十九半。
見去日，十四度。
平見，在春分前，以四乘去立春日；小滿前，又三乘去春分日，增春分所乘者；白露後，亦四乘去寒露日；小暑，加七日；小雪前，以八乘去寒露日；冬至後，以八乘去立春日，為減，小雪至冬至減七日。
見，初日行萬一千八百一十八分，日益遲七十分，百一十日行十八度、分四萬七百三十八而留。二十八日乃逆，日退六千四百三十六分，八十七日退十二度、分二百四。又留二十八日。初日行四千一百八十八分，日益疾七十分，百一十日亦行十八度、分四萬七百三十八而伏。
火數，三千六百三十七萬七千五百九十五。
伏半平，三百三十七萬九千三百二十七半。
複日，七百七十九；餘，四萬一千九百一十九。
歲再，殘日，四十九；餘，萬九千一百六。
見去日，十六度。
平見，在雨水前，以十九乘去大寒日：清明前，又十八乘去雨水日，增雨水所乘者；夏至後，以十六乘去處暑日；小滿後，又十五日；寒露前，以十八乘去白露日；小雪前，又十七乘去寒露日，增寒露所乘者；大雪後，二十九乘去大寒日，為減，小雪至大雪減二十五日。
見，初在冬至，則二百三十六日行百五十八度，以後日度隨其日數增損各一；盡三十日，一日半損一；又八十六日，二日損一；複三十八日，同；又十五日，三日損一；複十二日，同；又三十九日，三日增一；又二十四日，二日增一；又五十八日，一日增一；複三十三日，同；又三十日，二日損一，還終至冬至，二百三十六日行百五十八度。其立春盡春分，夏至盡立夏，八日減一日；春分至立夏，減六日；立秋至秋分，減五度，各其初行日及度數。白露至寒露，初日行半度，四十日行二十度。以其殘日及度，計充前數，皆差行，日益遲二十分，各盡其日度乃遲，初日行分二萬二千六百六十九，日益遲一百一十分，六十一日行二十五度、分萬五千四百九。初減度五者，於此初日加分三千八百二十三、篾十七；以遲日為母，盡其遲日行三十度，分同，而留十三日。
前減日分於二留，乃逆，日退分萬二千五百二十六，六十三日退十六度、分四萬二千八百三十四。又留十三日而行，初日萬六千六十九，日益疾百一十分，六十一日行二十五度、分萬五千四百九。立秋盡秋分，增行度五，加初日分同前，更疾。在冬至則二百一十三日行百三十五度；盡三十六日，一日損一；又二十日，二日損一；複二十四日，同；又五十四日，三日日增一；又十二日，二日增一；又四十二日，一日增一；又十四日，一日增一半；又十二日，增一；複四十五日，同；又一百六日，二日損一，亦終冬至二百一十三日，行百三十五度。
前增行度五者，於此亦減五度，為疾日及數。其立夏盡夏至初，日行半度，六十日行三十度。夏至盡立秋，亦初日行半度，四十日行二十度。其殘亦計充如前，皆差行，日益疾二十分，各盡其日度而伏。
土數，千七百六十三萬五千五百九十四。
伏半平，八十六萬四千九百九十五。
複日，三百七十八；餘，四千一百六十二。
歲一，殘日，十二；餘，三萬九千三百九十九半。
見去日，十六度半。
平見，在大暑前，以七乘去小滿日；寒露後，九乘去小雪日，為加，大暑至寒露加八日。小寒前，以九乘去小雪日；雨水後，以四乘去小滿日；立春後，又三乘去雨水日，增雨水所乘者，為減，小寒至立春減八日。
見，日行分四千三百六十四，八十日行七度、分二萬二千六百一十二而留三十九日乃逆，日退分二千八百二十，百三日退六度、分萬五百九十六。又留三十九日，亦行分日四千三百六十四，八十日行七度、分二萬二千六百一十二而伏。
金數，二千七百二十三萬六千二百八。
晨伏半平，百九十五萬七千一百四。
複日，五百八十三；餘，四萬二千七百五十六。
歲一，殘日，二百一十八；餘，三萬一千三百四十九半。
夕見伏，二百五十六日。
晨見伏，三百二十七日；餘與複同。
見去日，十一度。
夕平見，在立秋前，以六乘去芒種日；秋分後，以五乘去小雪日；小雪後，又四乘去大雪日，增小雪所乘者，為加，立秋至秋分加七日。立春前，以五乘去大雪日；雨水前，又四乘去立春日，增立春所乘者；清明後，以六乘去芒種日，為減，雨水至清明減七日。
晨平見，在小寒前，以六乘去冬至日；立春前，又五乘去小寒日，增小寒所乘者；芒種前，以六乘去夏至日；立夏前，又五乘去芒種日，增芒種所乘者，為加，立春至立夏加五日。小暑前，以六乘去夏至日；立秋前，又五乘去小暑日；增小暑所乘者；大雪後，以六乘去冬至日；立冬後，又五乘去大雪日，增大雪所乘者，為減，立秋至立冬減五日。
夕見，百七十一日行二百六度。其穀雨至小滿、白露至寒露，皆十日加一度；小滿至白露，加三度。乃十二日行十二度。冬至後，十二日減日度各一，雨水盡夏至，日度七；夏至後六日增一。大暑至立秋，還日度十二；至寒露，日度二十二，後六日減一。自大雪盡冬至，又日度十二而遲。日益疾五百二十分，初日行分二萬三千七百九十一、篾三十五，行日為母，四十三日行三十二度。
前加度者，此依減之。留九日乃逆，日退太半度，九日退六度，而夕伏晨見。日退太半度，九日退六度。複留，九日而行，日益遲五百二十分，初日行分四萬五千六百三十一、篾三十五，四十三日行三十二度。芒種至小暑，大雪至立冬，十五日減一度；小暑至立冬，減二度。又十二日行十二度。冬至後，十五日增日度各一。驚蟄至春分，日度十七，後十五日減一，盡夏至，還日度十二。後六日減一，至白露，日度皆盡。霜降後，五日增一，盡冬至，又日度十二。乃疾，百七十一日行二百六度。前減者，此亦加之，而晨伏。
水數，五百四十萬五千六。
晨伏半平，七十九萬九十九。
複日，百一十五；餘，四萬九百四十六。
夕見伏，五十一日。
晨見伏，六十四日；餘與複同。
見去日，十七度。
夕應見，在立秋後小雪前者不見；其白露前立夏後，時有見者。
晨應見，在立春後小滿前者不見；其驚蟄前立冬後，時有見者。
夕見，日行一度太，十二日行二十度。小暑至白露，行度半，十二日行十八度，乃八日行八度。大暑後，二日去度一，訖十六日，而日度俱盡。而遲，日行半度，四日行二度。益遲，日行少半度，三日行一度。前行度半者，去此益遲。乃留四日而夕伏晨見，留四日，為日行少半度，三日行一度。大寒至驚蟄，無此行，更疾，日行半度；四日行二度；又八日行八度。亦大寒後，二日去度一；訖十六日，亦日度俱盡。益疾，日行一度太，十二日行二十度。初無遲者，此行度半，十二日行十八度而晨伏。
推星平見術：
各以伏半減積半實，乃以其數去之；殘返減數，滿氣日法為日，不滿為餘，即所求年天正冬至後平見日餘。金、水滿晨見伏日者，去之，晨平見。求平見月日：以冬至去定朔日、餘，加其後日及餘，滿複日又去，起天正月，依定大小朔除之，不盡算外日，即星見所在。求後平見，因前見去其歲一、再，皆以殘日加之，亦可。其複日，金水準以晨夕見伏日，加晨得夕，加夕得晨。
求常見日：以轉法除所得加減者，為日；其不滿，以餘通乘之，為餘；並日，皆加減平見日、餘，即為常見日及餘。
求定見日：以其先後已通者，先減後加常見日，即得定見日餘。
求星見所在度：
置星定見、其日夜半所在宿度及分，以其日先後餘，分前加、分後減氣日法，而乘定見餘，氣日法而一所得加夜半度分，乃以星初見去日度數，晨減夕加之，即星初見所在宿度及分。
求次日：
各加一日所行度及分。其有益疾、遲者副置一日行分，各以其分疾增、遲損，乃加之。有篾者，滿法從分，其母有不等，齊而進退之。留即因前，逆則依減入虛去分，逆出先加。皆以篾法除，為轉分；其不盡者，仍謂之篾，各得每日所在知去日度。增以日所入先後分，定之。諸行星度求水其外內，准月行增損黃道而步之；不明者，依黃道而求所去日度。先後分亦分明前加後減。其金、火諸日度，計數增損定之者。其日少度多，以日減度之殘者，與日多度少之度，皆度法乘之，日數而一，所得為分。不滿篾，以日數為母。日少者以分並減之一度，日多者直為度分，即皆一日平行分。其差行者，皆減所行日數一，乃半其益疾、益遲分而乘之，益疾以減、益遲以加一日平行分，皆初日所行分。有計日加減，而日數不滿未得成度者，以氣日法若度法乘，見已所行日即日數除之，所得以增損其氣日疾法，為日及度。其不成者，亦即為篾。其木、火、土，晨有見而夕有伏；金、水即夕見還夕伏，晨見即晨伏。然火之初行及後疾，距冬至日計日增損日度者，皆當先置從冬至日餘數，累加於位上，以知其去冬至遠近，乃以初見與後疾初日去冬至日數而增損定之，而後依其所直日度數行之也。
