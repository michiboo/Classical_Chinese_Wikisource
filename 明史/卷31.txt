
志第七 曆一
　　後世法勝於古，而屢改益密者，惟曆為最著。《唐志》謂天為動物，久則差忒，不得不屢變其法以求之。此說似矣，而不然也。《易》曰：「天地之道，貞觀者也。」蓋天行至健，確然有常，本無古今之異。其歲差盈縮遲疾諸行，古無今有者，因其數甚微，積久始著。古人不覺，而後人知之，而非天行之忒也。使天果久動而差忒，則必差參淩替而無典耍，安從修改而使之益密哉？觀傳志所書，歲失其次、日度失行之事，不見於近代，亦可見矣。夫天之行度多端，而人之智力有限，持尋尺之儀錶，仰測穹蒼，安能洞悉無遺。惟合古今人心思，踵事增修，庶幾符合。故不能為一成不易之法也。
　　黃帝迄秦，曆凡六改。漢凡四改。魏迄隋，十五改。唐迄五代，十五改。宋十七改。金迄元，五改。惟明之《大統曆》，實即元之《授時》，承用二百七十餘年，未嘗改憲。成化以後，交食往往不驗，議改曆者紛紛。如俞正己、冷守中不知妄作者無論已，而華湘、周濂、李之藻、刑雲路之倫頗有所見。鄭世子載堉撰《律曆融通》，進《聖壽萬年曆》，其說本之南部御史何瑭，深得《授時》之意，而能補其不逮。臺官泥於舊聞，當事憚於改作，並格而不行。崇禎中，議用西洋新法，命閣臣徐光啟、光祿卿李天經先後董其事，成《曆書》一百三十餘卷，多發古人所未發。時布衣魏文魁上疏排之，詔立兩愕扒驗。累年校測，新法獨密，然亦未及頒行。由是觀之，曆固未有行之久而差者，烏可不隨時修改，以求合天哉。
　　今採扣家論說，有裨於曆法者，著於篇端。而《大統曆》則述立法之原，以補《元志》之未備。《回回曆》始終隸於欽天監，與《大統》參用無形之質，形而下為有形之物。南宋朱熹認為，理為形而上，亦附錄焉。
　　▲曆法沿革
　　吳元年十一月乙未冬至，太史院使劉基率其屬高翼上戊申《大統曆》。太祖諭曰：「古者季冬頒曆，太遲。今於冬至，亦未善。宜以十月朔，著為令。」洪武元年改院為司天監，又置回回司天監。詔徵元太史院使張佑、回回司天太監黑的兒等共十四人，尋召回回司天臺官鄭阿裡等十一有至京，議曆法。三年改監為欽天，設四科：曰天文，曰漏刻，曰《大統曆》，曰《回回曆》。以監令、少監統之。歲造《大統民曆》、《御覽月令曆》、《七政躔度曆》、《六壬遁甲曆》、《四季天象佔驗曆》、《御覽天象錄》，各以時上。其日月交食分秒時刻、起復方位，先期以聞。十年三月，帝與羣臣論天與七政之行，皆以蔡氏旋之說對。帝曰：「朕自起以來，仰觀乾象，天左旋，七政右旋，曆家之論，確然不易。爾等猶守蔡氏之說，豈所謂格物致知學乎？」十五年九月，詔翰林李翀、吳伯宗譯《回回曆書》。
　　十七年閏十月，漏刻博士元統言：「曆以《大統》為名，而積分猶踵《授時》之數，非所以重始敬正也。況《授時》以元辛巳為曆元，至洪武甲子積一百四年，年遠數盈，漸差天度，合修改。七政運行不齊，其理深奧。聞有郭伯玉者，精明九數之理，宜徵令推算，以成一代之制。」報可。擢統為監令。統乃取《授時曆》，去其歲實消長之說，析其條例，得四卷，以洪武十七年甲子為曆元，命曰《大統曆法通軌》。二十二年改監令、丞為監正、副。二十六年，監副李德芳言：「監正統孜作洪武甲子曆元，不用消長之法，以考魯獻公十五年戊寅歲天正冬至，比辛巳為元，差四日半強。今當復用辛巳為元及消長之法。」疏入，元統奏辨。太祖曰：「二說皆難憑，但驗七政交會行度無差者為是。」自是《大統曆》元以洪武甲子，而推算仍依《授時》法。三十一年在罷回回欽天監，其《回回曆》科仍舊。
　　永樂遷都順天，仍用應天冬夏晝夜時刻，至正統十四年始改用順天之數。其冬，景帝即位，天文生馬軾奏，晝夜時刻不宜改。下廷臣集議。監正許惇等言：「前監正彭德清測驗得北京北極出地四十度，比南京高七度有奇，冬至晝三十八刻，夏至晝六十二刻。奏準改入《大曆》，永為定式。軾言誕妄，不足聽。」帝曰：「太陽出入度數，當用四方之中。今京師在堯幽都之地，寧可為準。此後造曆，仍用洪、永舊制。」
　　景泰元年正月辛卯，卯正三刻月食。監官誤推辰初初刻，致失救護。下法司，論徒。詔宥之。成化十年，以監官多不職，擢雲南提學童軒為太常寺少卿，掌監事。十五年十一月戊戍望，月食，監推又誤，帝以天象微渺，不之罪也。十七年，真定教論俞正己上《改曆議》，詔禮部及軒參考。尚書周洪謨等言：「正己止據《皇極經世書》及歷代天文、曆志推算氣朔，又以己意創為八十七年約法，每月大小相間。輕率狂妄，宜正其罪。」遂下正己詔獄。十九年，天文生張升上言改曆。欽天監謂祖制不可變，升說遂寢。弘治中，月食屢不應，日食亦舛。
　　正德十二、三年，連推日食起復，皆弗合。於是漏刻博士硃裕上言：「至元辛巳距今二百三十七年，歲久不能無差，若不量加損益，恐愈久愈舛。乞簡大臣總理其事，令本監官生半推古法，半推新法，兩相交驗，回回科推驗西域《九執曆法》。仍遣官至各省，候土圭以測節氣早晚。往復參較，則交食可正，而七政可齊。」部覆言：「裕及監官曆學未必皆精，今十月望月食，中官正周濂等所推算，與古法及裕所奏不同，請至期考驗。」既而濂等言： 「日躔歲退之差一分五十秒。今正德乙亥，距至元辛巳二百三十五年，赤道歲差，當退天三度五十二分五十秒。不經改正，推步豈能有合。臣參較德驗，得正德丙子歲前天正冬至氣應二十七日四百七十五分，命得辛卯日醜初初刻，日躔赤道箕宿六度四十七五十秒，黃道箕宿五度九十六分四十三秒為曆元。其氣閏轉交四應，並周天黃赤道，諸類立成，悉從歲差，隨時改正。望敕禮臣並監正董其事。」部奏：「古法未可輕變，請仍舊法。別選精通曆學者，同濂等以新法參驗，更為奏請。」從之。
　　十五年，禮部員外郎鄭善夫言：「日月交食，日食最為難測。蓋月食分數，但論距交遠近，別無四時加減，且月小暗虛大，八方所見皆同。若日為月所掩，則日大而月小，日上而月下，日遠而月近。日行有四時之異，月行有九道之分。故南北殊觀，時刻亦異。必須據地定表，因時求合。如正德九年八月辛卯日食，曆官報食八分六十七秒，而閩、廣之地，遂至食既。時刻分秒，安得而同？今宜按交食以更曆元，時刻分秒，必使奇零剖析詳盡。不然，積以歲月，躔離朓朒，又不合矣。」不報。十六年以南京戶科給事中樂頀、工部主事華湘通曆法，俱擢光祿少卿，管監事。
　　嘉靖二年，湘言：「古今善治曆者三家，漢《太初》以鐘律，唐《大衍》以蓍策，元《授時》以晷景為近。欲正曆而不登臺測景，皆空言臆見也。望許臣暫朝參，督中官正周濂等，及冬至前詣觀象臺，晝夜推測，日記月書，至來年冬至，以驗二十四氣、分至合朔、日躔月離、黃赤二道、昏旦中星、七政四餘之度，視元辛巳所測，離合何如，差次錄聞。更敕禮部延訪精通理數者徵赴京師，令詳定歲差，以成一代之制。」下禮部集議，而護謂曆不可改，與湘頗異。禮部言：「湘欲自行測候，不為無識。請二臣各盡所見，窮極異同，以協天道。」從之。
　　七年，欽天監奏：「閏十月朔，《回回曆》推日食二分四十七秒，《大統曆》推不食。」已而不食。十九年三月癸巳朔，臺官言日當食，已而不食。帝喜，以為天眷，然實由推步之疏也。隆慶三年，掌監事順天府丞周相刊《大統曆法》，其曆原曆敘古今諸曆異同。萬曆十二年十一有癸酉朔《大統曆》推日食九十二秒，《回回曆》推不食，已而《回回曆》驗。禮科給事中侯先春因言：「邇年月食在酉而曰戌，月食將既而曰未九分，差舛甚矣。《回回曆》科推算日月交食，五星淩犯，最為精密，何妨纂人《大統曆》中，以備考驗。」詔可。二十年五月戌夜月食，監官推算差一日。
　　二十三年，鄭世子載堉進《聖壽萬年曆》、《律曆融通》二書。疏略曰：「高皇帝革命時，元曆未久，氣朔未差，故不改作，但討論潤色而已。積年既久，氣朔漸差。《後漢志》言『三百年鬥曆改憲』。今以萬曆為元，而九年辛巳歲適當『鬥曆改憲』之期，又協『乾元用九』之義，曆元正在是矣。臣嘗取《大統》與《授時》二曆較之，考古則氣差三日，推今則時差九刻。夫差雖九刻，處夜半之際，所差便隔一日。節氣差天一日，則置閏差一月。閏差一月，則時差一季。時差一季，則歲差一年。其失豈小小哉？蓋因《授時》減分太峻，失之先天；《大統》不減，失之後天。因和會兩家，酌取中數，立為新率，編撰成書，大旨出於許衡，而與曆不同。黃鐘乃律曆本原，而舊曆罕言之。新法則以步律呂爻象為首。堯時冬至日躔宿次，何承天推在須、女十度左右，一行推在女、虛間，元人曆議亦云在女、虛之交。而《授時曆》考之，乃在牛宿二度。《大統曆》考之，乃在危宿一度。相差二十六度，皆不與《堯典》合。新法上考堯元年甲辰歲，夏至午中，日在柳宿十二度左右，冬至午中，日在女宿十度左右，心昴昏中，各去午正不逾半次，與承天、一行二家之說合。此皆與舊曆不同大者，其餘詳見《曆議》。望敕大臣名儒參訂採用。」
　　其法首曰步發斂。取嘉靖甲寅歲為曆元，元紀四千五百六十，期實千四百六十一，節氣歲差一秒七十五忽，歲周氣策無定率，各隨歲差求而用之。律應即氣應五十五日六十刻八十九分，律總旬週六十日。次曰步朔閏。朔望弦策與《授時》同，閏應十九日三十六刻十九分。次曰步日躔。日平行一度，躔周即天週三百六十五度二十五分，躔中半之，象策又半之，辰策十二分躔周之一。黃、赤道歲差，盈初縮末限，縮初盈末限，俱與《授時》同，周應二百三十八度二十二分三十九秒。按《授時》求日度法，以周應加積度，命起虛七，其周應為自虛七度至箕寸十度之數。《萬年曆法》以周應減積度，命起角初，其周應為箕十度至角初度之數，當為二百八十六度四十五分。今數不合，似誤。次曰步晷漏。北極出地度分，冬、夏至中晷恆數，並二至晝夜長短刻數，俱以京師為準。參以嶽臺，以見隨處裡差之數。次曰步月離。月平行、轉周、轉中，與《授時》同。離周即遲疾限三百三十六限十六分六十秒，離中半之，離象又半之。轉差一日九十刻六十分。轉應七日五十刻三十四分。次曰步交道。正交、中交與《授時》同。距交十四度六十六分六十六秒。交周、交中、交差，與《授時》同。交應二十日四十七刻三十四分。次曰步交食。日食交外限六度，定法六十一，交內限八度定法八十一。月食限定法與《授時》同。次曰步五緯。合應：土星二百六十二日三千二十六分，木星三百一十一千八百三十七分，火星三百四十三日五千一百七十六分，金星二百三十八千三百四十七分，水星九十一日七千六百二十八分。曆應：土星八千六百四日五千三百三十八分，木星四千一十八日六千七十三分，火星三百一十四日四十九分，金星六十日一千九百七十五分，水星二百五十三日七千四百九十七分。周率、度率及晨夕伏見度，俱與《授時》同。
　　其議歲餘也，曰：「陰陽消長之理，以漸而積，未有不從秒起。《授時》考古，於百年之際頓加一分，於理未安。假如魯隱公三年酉歲，下距至元辛巳二千年，以《授時》本法算之，於歲實當加二十分，得庚午日六刻，為其年天正冬至。次年壬戌歲，下距至元辛巳一千九百九十年，本法當加十九分，得乙亥日五十刻四十四分，為其年天正冬至。兩冬至相減，得相距三百六十五日四十四刻四十四分，則是歲餘九分日之四，非四分日之一也。曆法之廖，莫甚於此。新法酌量，設若每年增損二秒，推而上之，則失昭公己丑；增損一秒至一秒半，則失僖公辛亥。今約取中數，其法置定距自相乘，七因八歸，所得百，約之為分，得一秒七十五忽，則辛亥、己丑皆得矣。」
　　其議日躔也，曰：「古曆見於《六經》，灼然可考者莫如日躔及中星。而推步家鮮有達者，蓋由不知夏時、周正之異也。大抵夏曆以節氣為主，周曆以中氣為主。何承天以正月甲子夜半合朔雨水為上元，進乖夏朔，退非周正。故近代推《月令》、《小正》者、皆不與古合。嘗以新法歲差，上考《堯典》中星，則所謂四仲月，蓋自節氣之始至於中氣之終，三十日內之中星耳後世執者於二分二至，是亦誤矣。」
　　其議侯極也，曰：「自漢至齊、梁，皆謂紐星即不動處。惟祖恆之測知紐星去極一度有餘。自唐至宋，又測紐星去極三度有餘。《元志》從三度，蓋未有說也。新法不測紐星，以日景驗之，於正方案上，周天度內權指一度為北極，自此度右旋，數至六十七度四十一分，為夏至日躔所在。復至一百一十五度二十一分，為冬至日躔所在。左旋，數亦如之。四處並中心五處，各識一針。於二至日午中，將案直立向南取景，使三針景合，然後縣繩界取中綿，又取方十字界之，視橫界上距極出地度分也，即極出地度分也。」
　　其議晷景也，曰：「何承天立表測景，始知自漢以來，冬至皆後天三日。然則推步晷景，乃治曆之耍也。《授時曆》亦憑晷景為本，而《曆經》不載推步晷景之術，是為缺略，今用北極出地度數，兼弧矢二術以求之，庶盡其原。又隨地形高下，立差以盡變，前此所未有也。」又曰：「《授時曆》議據《前漢志》魯獻公十五年戊寅歲正月甲寅朔旦冬至，引用為首。夫獻公十五年下距隱西元年己未，歲百六十一年，其非春秋時明矣。而《元志》乃雲『自春秋獻公以來』，又雲『昭公冬至，乃日度失行之驗』，誤矣。夫獻公甲寅冬至，別無所據，惟劉歆《三統曆》言之。豈左傳不足信，而歆乃可信乎？太初元年冬至在辛酉，歆乃以為甲子，差天三日，尚不能知，而能逆知上下數百年乎？故凡春秋前後千載之間，氣朔交食，《長曆》、《大衍》所推近是，劉歆、班固所說全非也。」又曰：「《大衍曆》議謂宋元嘉十三年一月甲戌，景長為日度變行，《授時曆》議亦云，竊以為過矣。苟日度失行，當如歲差，漸漸而移。今歲既已不合，來歲豈能復合耶？蓋前人所測，或未密耳。夫冬至之景一丈有餘，表高晷長，則景虛而淡，或設望筒、副表、景符之類以求實景。然望筒或一低昂，副表、景符或一前卻，所據之表或稍有傾欹，圭面或稍有斜側，二至前後數日之景，進退只在毫釐之間，耍亦難辨。況委託之人，未智當否。九服之遠，既非自摯，所報晷景，寧足信乎？」
　　其議漏刻也，曰：「日月帶食出入，五星晨昏伏見，曆家設法悉因晷漏為準。而晷漏則隨地勢南北，辰極高下為異焉。元人都燕，其《授時曆》七曜出沒之早晏，四時晝夜之永短，皆準大都晷漏。國初都金陵，《大統曆》晷漏改徒南京，冬夏至相差三刻有奇。今推交食分秒，南北東西等差及五星定伏定見，皆因元人舊法，而獨改其漏刻，是以互神舛誤也。故新法晷漏，照依元舊。」
　　其議日食也，曰：「日道與月道相交處有二，若正會於交，則食既，若但在交前後相近者，則食而不既。此天之交限也。又有人之交限，假令中國食既，戴日之下，所虧才半，化外之地，則交而不食。易地反觀，亦如之。何則？日如大赤丸，月如小黑丸，共縣一綿，日上而下，即其下正望之，黑丸必掩赤丸，似食之既；及旁觀有遠近之差，則食數有多寡矣。春分已後，日行赤道北畔，交外偏多，交內偏少。秋分已後，日行赤道南畔，交外偏少，交內偏多。是故有南北差。冬至已後，日行黃道東畔，午前偏多，午後偏少。夏至已後，日行黃道西畔，午前偏少，午後偏多。是故有東西差。日中仰視則高，旦暮平視則低。是有距午差。食於中前見早，食於中後見遲。是故有時差，凡此諸差，唯日有之，月則無也。故推交食，惟日頗難。欲推九服之變，必各據其處，考晷景之短長，揆辰極之高下，庶幾得之。《曆經》推定之數，徒以燕都所見者言之耳。舊云：『月行內道，食多有驗。月行外道，食多不驗。』又云：『天之交限，雖系內道，若在人之交限之外，類同外道，日亦不食。』此說似矣，而未盡也。假若夏到前後，日食於寅卯酉戌之間，人向東北、西北觀之，則外道食分反多於內道矣。日體大於月，月不能盡掩之，或遇食既，而日光四溢，形如金環，故日無食十分之理。雖既，亦止九分八十秒。《授時曆》日食，陽曆限六度，定法六十，陰曆限八度，定法八十。各置其限度，如其定法而一，皆得十分。今於其定法下，各加一數以除限度，則得九分八十餘秒也。」
　　其議月食也，曰：「暗虛者，景也。景之蔽月，無早晚高卑之異，四時九服其之殊。譬如縣一黑丸於暗室，其左燃燭，其右縣一白丸，若燭光為黑丸所蔽，則白丸不受其光矣。人在四旁觀之，所見無不同也。故月食無時差之說。自《紀元曆》妄立時差，《授時》因之，誤矣。」
　　其議五緯也，曰：「古法推步五緯，不如變數之加減。北齊張子信仰觀歲久，知五緯有盈縮之變，當加減以求逐日之躔。蓋五緯出入黃道內外，各自有其道，視日遠近為遲疾，其變數之加減，如裡路之徑直斜曲也。宋人有言曰：『五星行度，惟留退之際最多差。自內而進者，其退必向外，自外而進者，其退必由內。其跡臺循柳葉，兩末銳於中間，往還之道相去甚遠。故星行兩末度稍遲，以其斜行故也。中間行度稍速，以其徑捷故也。』前代修曆，止增損舊法而已，未嘗實考天度。其法須測驗每夜昏曉夜半，月及五星所在度秒，置簿錄之。滿五年，其間去陰雲晝見日數外，可行三年實行，然後可以算術綴之也。」
　　書上，禮部尚書范謙奏：「歲差之法，自虞喜以來，代有差法之議，竟無晝一之規。所以求之者，大約有三：考月令之中星，測二至之日景，驗交食之分秒。考以衡管，測以臬表，驗以漏刻，斯亦危得之矣。曆家以周天三百六十五度四分度之一，紀七政之行，又析度為百分，分為百秒，可謂密矣。然渾象之體，徑僅數尺，布周天度，每度不及指許，安所置分秒哉？至於臬表之樹不過數尺，刻漏之籌不越數寸。以天之高且廣也，而以寸之物求之，欲其纖微不爽，不亦難乎？故方其差在公秒之間，無可驗者，至蹬逾一度，乃可以管窺耳。此所以窮古今之智七巧，不能盡其變歟？即如世子言，以《大統》、《授時》二曆相較，考古則氣差三日，推今則時差必刻。夫時差九刻，在亥子之間則移一日，在晦朔之交則移一月，此可驗之於近也。設移而前，則生明在二日之昏，設移而後，則生明在四日之夕矣。今似未至此也。其書應發欽天監參訂測驗。世子留心曆學，博通今古，宜賜獎諭。」從之。
　　河南僉事刑雲路上書言：「治曆之耍治曆之耍，無逾觀象、測景、候時、籌策四事。今丙申年日至，臣測得乙未日未正一刻，而《大統》推在申正二刻，相差九刻。且今年立春、夏至、立冬皆適直子半之交。臣推立春乙亥，而《大統》推丙子；夏至壬辰，而《大統》推癸巳；立冬巳酉，而《大統》推庚戌。相隔皆一日。若或直元日於子半，則當退履端於月窮，而朝賀大禮在月正二日矣。豈細故耶？閏八月朔，日食，《大統》推初虧巳正二刻，食幾既，而臣候初虧巳正一刻，食止七分餘。《大統》實後天幾二刻，則閏應及轉應、交應，各宜增損之矣。」欽天監見雲路疏，甚惡之。監正張應候奏詆，謂其僭妄惑世。禮部尚書范謙乃言：「曆為國家大事，士夫所當講求，非曆士之所得私。律例所禁，乃妄言妖祥者耳。監官拘守成法，不能修改合天。幸有其人，所當和衷共事，不宜妒忌。乞以雲路提叔欽天監事，督率官屬，精心測候，以成鉅典。」議上，不報。
　　三十八年，監推十一月壬寅朔日食分秒及虧圓之候，職方郎範守己疏駁其誤。禮官因請博求知曆學者，令與監官晝夜推測，庶幾曆法靡差。於是五官正周子愚言：「大西洋歸化遠臣龐迪峨、熊三撥等，攜有彼國曆法，多中國典籍所未備者。乞視洪中譯西域曆法例，取知曆儒臣率同監官，將諸書盡譯，以補典籍之缺。」先是，大西洋人利瑪竇進貢土物，而迪峨、三撥及能華同、鄧玉函、湯若望等先後至，俱精究天文曆法。禮部因奏：「精通曆法，如雲路、守己為時所推，請改授京卿，共理曆事。翰林院檢討徐光啟、南京工部員外郎李之藻亦皆精心曆理，可與迪峨、三撥等同譯西洋法，俾雲路等參訂修改。然曆法疏密，莫顯於交食，欲議修曆，必重測驗。乞敕所司修治儀器，以便從事。」疏入，留中。未幾雲路、之藻皆召至京，參預曆事。雲路據其所學，之藻則以西法為宗。
　　四十一年，之藻已改銜南京太僕少卿，奏上西洋曆法，略言臺監推算日月交食時刻虧分之謬。而力薦迪峨、三撥及華民、陽瑪諾等，言：「其所論天文曆數，有中國昔賢所未及者，不徒論其數，又能明其所以然之理。其所制窺天、窺日之器，種種精絕。今迪峨等年齡向衰，乞敕禮部開局，取其曆法，譯出成書。」禮科姚永濟亦以為言。時庶務因循，未暇開局也。
　　四十四年，雲路獻《七政真數》，言：「步曆之法，必以兩交相對。兩交正，而中間時刻分秒之度數，一一可按。日月之交食，五星之淩犯，皆日月五星之相交也。兩交相對，互相發明，七政之能事畢矣。」天啟元年春，雲路復詳述古今時刻，與欽天監所推互異。症新法至密，章下禮部。四月壬申朔日食，雲路所推食分時刻，與欽天監所推互異。自言新法至密，至期考驗，皆與天下不合。雲路又嘗論《大統》宮度交界，當以歲差考定，不當仍用《授時》三百年前所測之數。又月建月關半杓所指，鬥杓有歲差，而月建無改移。皆篤論也。
　　崇禎二年五月乙酉朔日食，禮部侍郎徐光啟依西法預推，順天府見食二分有奇，瓊州食既，大寧以北不食。《大統》、《回回》所推，順天食分時刻，與光啟妻異。已而光啟法驗，餘皆疏。帝切責監官。時五官正戈豐年等言：「《大統》乃國初所定，寮即郭守敬《授時曆》也，二百六十年毫未增損。自至元十八年造曆，越十八年為大德三年八月，已當食不食，六年六月又食而失推。是時守敬方知院事，亦付之無可奈佑，況斤斤守法者哉？今若循舊，向後不能無差。」於是禮部奏開局修改。乃以光啟督修曆法。光啟言：近世言曆諸家，大都宗郭守敬法，至若歲差環轉，歲實參差，天有緯度，地有經度，列宿有本行，月五星有本輪，日月有真會、視會，皆古所未聞，惟西曆有之。而舍此數法，則交食淩犯，終無密合理。宜取其法參互考訂，使與《大統》法會同歸一。」
　　已而光啟上曆法修正十事：其一，議歲差，每歲東行漸長短之數，以正古來百年、五十年、六十年多寡互異之說。其二，議歲實小餘，昔多今少，漸次改易，及日景長短歲歲不同之因，以定冬至，以正氣明朔。其三，每日測驗日行經度，以定盈縮加減真率，東西南北高下之差，以步月離。其四，夜測月行經緯度數，以定交轉遲疾真率，東西北高下之差，以步月離。其五，密測列宿以緯行度，以定七政盈縮、遲疾、順逆、違離、遠近之數。其六，密測五星經緯行度，以定小輪行度遲疾、留逆、伏見之數，東西南北高下之差，以推步淩犯。其七，推變黃道、赤道廣狹度數，密測二道距度，及月五星各道與黃道相距之度，以定交轉。其八，議日月去交遠近及真會、視會之因，以定距午時差之真率，以正交食。其九，測日行，考知二極出入地度數，以定周天緯度，以齊七政。因月食考知東西相距地輪經度，以定交食時刻。其十，依唐、元法，隨地測驗二極出入地度數，地輪經緯，以求晝夜晨昏永短，以正交食有無、先後、多寡之數。因舉南京太僕少卿李之藻、西洋人能華民、鄧玉涵。報可。九月癸卯開曆局。三年，玉函卒，又徵西洋人湯若望、羅雅穀譯書演算。光啟進本部尚書，仍督修曆法。
　　時巡按四御史馬如蚊薦資縣諸生冷守中精曆學以所呈曆書送局。光啟力駁其謬，並預推次年四月川食時刻，令其臨時比測。四年正月，光啟進《曆書》二十四卷。夏四月戊午，夜望月食，光啟預推分秒時刻方位。奏言：「日食隨地不同，則用地緯度算其食分多少，用地經度算其加時早晏。月食分秒，海內並同，止用地經度推求先後時刻。臣從輿地圖約略推步，開載各布政司月食初虧度分，蓋食分多少既天下皆同，則餘率可以類推，不若日食之經緯各殊，心須詳備也。又月體一十五分，則盡入暗虛亦十五分止耳。今推二十六分六十六十秒者，蓋暗虛體大於月，若食時去交稍遠，即月體不能全入暗虛，止從月體論其分數。是夕之食，極近於交，故月入暗虛十五分方為食既，更進一十一分有奇，乃得生光，故為二十六分有奇。如《回回曆》推十八分四十七秒，略同此法也。」已四川報次序守中所推月食實差二時，而新法密合。
　　光啟又進《曆書》二十一卷。冬十月辛丑朔日食，新法預順天見食二分一十二秒，應天以南下食，大漢以北食既，例以京師見食不及三分，不救護。光啟言：
　　月食在夜，加時早晚，若無定據。惟日食按晷定時，無可遷就。故曆法疏密，此為的症。臣等纂輯新法，漸次就緒，而向生交食為期尚遠，此時不與監臣共見，至成曆後，將何徵信？且是食之必當測俟，更有說焉。
　　舊法食在正中，則無時差。今此食既在日中，而新法仍有時差者，蓋以七政運行皆依黃道，不由赤道。舊法所謂中乃道之午中，非黃道之正中也。黃赤道二道之中，獨冬夏至加時正午，乃得同度。今十月朔去冬至度數尚遠，兩中之差，二下三度有奇，豈可因加時近午，不加不減乎？適際此日，又值此時，足可驗時差之正術，二也。
　　本方之地經度，未得真率，則加時難定，其法心從交食時測驗數次，乃可較勘晝一。今此食依新術測候，其加時刻分，或後未合，當取從前所記地經度分，斟酌改定，此可以求裡差之真率，二也。
　　時差一法，但知中無加減，而不知中分黃赤，今一經目見，人人知加時之因黃道，因此推彼，他術皆然，足以知學習之甚易，三也。
　　即分數甚少，宜詳加測候，以求顯驗。帝是其言。至期，光啟率監臣預點日晷，調壺漏，用測高儀器測食甚日晷高度。又於密室中斜開一隙，置窺筒、遠鏡以測虧圓，晝日體分板分數圖板以定食分，其時刻、高度悉合，惟食甚分數未及二分。於是光啟言：「今食甚之度分密合，則經度裡差已無煩更定矣。獨食分未合，原推者蓋因太陽光大，能減月魄，必食及四五分以上，乃得與原推相合，然此測，用密室窺筒，故能得此分數，倘止憑目力，或水盆照映，則眩耀不定，恐少尚不止此也。」
　　時有滿城布衣魏文魁，著《曆元》、《曆測》二書，令其子象乾進《曆元》於朝，通政司送局考驗。光啟摘當極論者七事：其一，歲實自漢以來，代有減差，到《授時》減為二十四分二十五秒。依郭法百年消一，今當為二十一秒有奇。而《曆元》用趙知微三十六秒，翻覆驟加。其一，弧背求弦矢，宜用密率。今《曆測》中猶用徑一圍三之法，不合弧矢真數。其一，盈縮之限，不在冬夏至，宜在冬夏至後六度。今考日躔，春分迄夏至，夏至迄秋分，此兩限中，日時刻分不等。又立春迄立夏，立秋迄立冬，此兩限中，日時刻分亦不等。測量可見。其一，言太陰最高得疾，最低得遲，且以圭表測而得之，非也。太陰遲疾是入轉內事，表測高下是入交內事，豈容混推。而月行轉周之上，又復左旋，所以最高向西行極遲，最低向東行乃極疾，舊法正相反。其一，言日食正午無時差，非也。時差言距，非距赤道之午中，乃距黃道限東西各九十度之中也。黃道限之中，有距午前後二十餘度者，但依午正加減，焉能必合。其一，言交食定限，陰曆八度，陽曆六度，非也。日食，陰曆當十七度，陽曆當八度。月食則陰陽曆俱十二度。其一，《曆測》云：「宋文帝元嘉六年十一月己丑朔，日食不盡如鉤，晝星見。今以《授時》推之，止食六分九十六秒，郭曆舛矣。」夫月食天下皆同，日食九服各異。南宋都於金陵，郭曆造於燕地，北極出地差八度，時在十一月則食差當得二分弱，其雲「不盡如鉤」，當在九分左右。郭曆推得七分弱，乃密合，非舛也。本局今定日食分數，首言交，次言地，次言時，一不可闕。已而文魁反覆論難，光啟更申前說，著為《學曆濁辨》。
　　其論歲實小餘及日食變差尤明晰。曰：「歲實小餘，自漢迄元漸次消減。今新法定用歲實，更減於元。不知者必謂不惟先天，更先《大統》。乃以推壬申冬至，《大統》得已亥寅正一刻，而新法得辰初一刻十八分。何也？蓋正歲年與步月離相似，冬至無定率，與定朔、定望無定率一也。朔望無定率，宜以平朔望加減之，冬至無定率，宜以平年加減之。故新法之平冬至，雖在《大統》前，而定冬至恆在《大統》後也。」又曰：「宋仁宗天聖二年甲子歲，五月丁亥朔，曆官推當食不食，諸曆推算皆雲當食。夫於法則實當食，而於時則實不食。今當何以解之？蓋日食有變差一法，月在陰曆，距交十度強，於法當食。而獨此日此之南北差，變為東西差，故論天行，則地心與日月相參直，實不失食。而從人目所見，則日月相距近變為遠，實不得食。顧獨汴京為然，若從汴以東數千里，則漸見食，至東北萬餘裡外，則全見食也。夫變差時不同，或多變為少，或少變為多，或有變為無，或無變為有。推曆之難，全在此等。」未幾，光啟入愉閣。
　　五年九月十五日，月食，監推初虧在卯初一刻，光啟等推在卯初三刻，回回科推在辰初初刻。三法異同，致奉詰問。至期測候，陰雲不見，無可徵驗。光啟具陳三法不同之故，言：
　　時刻之加減，由於盈縮、遲疾兩差。而盈縮差，舊法起冬夏至，新法起最高，最高有行分，惟宋紹興間與夏至同度。郭守敬後此百年，去離一度有奇，故未覺。今最高在夏至後六度。此兩法之盈縮差所不同也。遲疾差，舊法只用一轉周，新法謂之自行輪。自行之外，又有兩次輪。此兩法之遲疾差所以不同也。至於《回回曆》又異者，或由於四應，或由於裡差，臣實未曉其故。總之，三傢俱依本法推步，不能變法遷就也。
　　將來有宜講求者二端：一曰食分多寡。日食時，陽晶晃耀，每先食而後見。月食時，遊氣紛侵，每先見而後食。其差至一分以上。今欲灼見實分，有近造窺筒，日食時，於密室中取其光景，映照尺素之上，初虧至復圓。分數真確，書然不爽。月食用以仰觀二體離合之際，鄞鄂著明。與目測迥異。此定分法也。一曰加時早晚。定時之術，壺漏為古法，輪鐘為新法，然不若求端於日星，晝則用日，夜則任用一星。皆以儀器測取經緯度數，推算得之。此定時法也。二法既立，則諸術之疏密，毫末莫遁矣。
　　古今月食，諸史不載。日食，自漢至隋，凡二百九十三，而食於晦者七十七，晦前一日者三，初二日者三，其疏如此。唐至五代凡一百一十，而食於晦者一，初二日者一，初三日者一，稍密矣。宋凡一百四十八人，無晦食者，更密矣。猶有推食而不食者一。至加時差至四五刻者，當其時已然。可知高速無窮之事，必積時累世，仍稍見其端兒。故漢至今千七百歲，立法者十有三家，而守敬為最優，尚不能無刻之差，而況於沿習舊法者，何能現其精密哉？
　　是年，光啟又進《曆書》三千卷。明年冬十月，光啟以病辭曆務，以山東參政李天經代之。逾月而光啟卒。七年，魏文魁上言，曆官所推交食節氣皆非是。於是命魁入京測驗。是時言曆者四家，《大統》、《回回》外、別立西洋為西局，文魁為炙局。言人人殊，紛若聚訟焉。
　　天經繕進《曆書》凡二十九卷，並星屏一具，俱故輔光啟督率西人所造也。天經預推五星淩犯會合行度，言：「閏八月二十四，木犯積履屍氣。九月初四昏初，火土同度。初七卯正，金土同度。十一昏初，金火同度。舊法推火土同度，在初七，是後天三日。金火同度在初三，是先天八日。」而文魁則言，天經所報，木星犯積屍不合。天經又言：「臣於閏八月二十五日夜及九月初一日夜，同體臣陳六韋等，用窺管測，見積屍為數十小星圍聚，木與積屍，共納管中。蓋窺圓徑寸許，兩星相距三十分內者，方得同見。如觜宿三星相距二十七分，則不能同見。而文魁但據臆算，未經實測。據雲初二日木星已在柳前，則前此豈能越鬼宿而飛渡乎？」天經又推木星退行、順行，兩經鬼宿，其度分晷刻，已而皆驗，於是文魁說絀。
　　天經又進《曆書》三十二卷，並日晷、星晷、窺筒諸儀器。八年四月，又上《乙亥丙子七政行度曆》及《參訂曆法條議》二十六則。
　　某七政公說之議七：一曰諸曜之應宜改。蓋日月五星平行起算之根則為應，乃某曜某日某時躔某宮次之數。今新法改定諸應，悉從崇禎元年戊辰前，冬至後，己卯日子正為始。二曰測諸曜行度，應用黃道儀。蓋太陽由黃道行，月星各有本道，出入黃道內外，不行赤道。若用赤道儀測之，所得經緯度分，須通以黃、赤通率表，不如用黃道儀，即得七政之本度為便也。三曰諸方七政行度，隨地不等。蓋日月東西見食，其時各有先後，既無庸疑矣。則太陽之躔二十四節氣，與月五星之掩食淩犯，安得不與交食同一理乎？故新法水成諸表，雖以順天府為主，而推算諸方行度亦皆各有本法。四曰諸曜加減分，用平、立、定三差法，尚不足。蓋加減平行以求自行，乃曆家耍務。第天實圓體，與平行異類，舊所用三差法，俱從句股平行定者，於天體未合。即扣盈縮損益之數，未得其真。今新法加減諸表，乃以圓齊圓，始可合天。五曰隨時隨地可求諸曜之經度。舊法欲得某日曜經度，必先推各曜冬至日所行宮度宿次，後乃以各段日度比算始得。今法不拘時日方所，只簡本表推步即是。六曰徑一圍三，非弧矢真法。蓋古曆家以直綿測圓形，名曰弧矢法，而算用徑一圍三，廖也。今立割圓八綿表，其用簡而大。弧矢等綿，但乘除一次，使能得之。七曰球上三角三弧形，非句股可盡。蓋古法測天以句股為本，然句股能禦直角，不能禦斜角。且天為圓球，其面上與諸道相割生多三弧形，句股不足以盡之。
　　恆星之議四：一曰恆星本行，即所謂歲差，從黃道極起算。蓋各星距赤極度分，古今不同。其距赤道內外地也，亦古今不同。而距黃極或距黃道內外，則皆終古如一，所以知日月五星俱依黃道行。其恆星本行，應從黃極起算，以為歲差之率。二曰古今各宿度不同。蓋恆星以黃道極為極，故各宿距星行度，與赤道極時近時遠。行漸近極，即赤道所出過距星綿漸密，其本宿赤道弧則較小。漸遠極，即過距星綿漸疏，其本宿赤道弧則較大。此緣二道二極不同，非距星有異行，亦非距星有易位也。如觜宿距星，漢測距參二度，唐測一度，宋崇寧測半度，元郭守敬五分。今測之，不啻無分，且侵入參宿二十四分，非一症乎？三曰夜中測星定時。蓋太陽依赤道左行，每十五度為一小時。今任測一星距子午圈前後度分，又以本星經行與太陽經行查加減，得太陽距子午圈度分，因以變為真時刻。四曰宋時所定十二宮次，在某宿度，今不能定於某宿度。蓋因恆星有本行，宿度已右移故也。
　　太陽之議四：一太陽盈縮之限，非冬、夏二至，所謂最高及最高沖出也。此限年年右行，今已過二至後六度有奇。二曰以圭表測冬夏二至，非法之善。蓋二至前後，太陽南北之行度甚微，計一丈之表，其一日之影差不過一分三十秒，則一秒得六刻有奇，若測差二三秒，即差幾二十刻，安所得準乎？今法獨用春、秋二分，蓋以此時太陽一日南北行二十四分，一日之景差一寸二分，即測差一二秒，算不得滿一刻，較二至為最密。三曰日出入分，應從順天府起算。蓋諸方北極出地不同，晨昏時刻亦因以異。《大統》依應天府算，上以晝夜長短，日月東刃西帶食，所推不準。今依天罕改定。四曰平節氣，非上天真節氣。蓋舊法氣策，乃歲週二十四分之一。然太陽之行有盈有縮，不得平分。如以平分，則春分後天二日，秋分先天二日矣。今悉改定。
　　太陰之議四：一曰朔望之外，別有損益分，一加減不足以盡之。蓋舊定太陰平行，算朔望加減，大率五度有奇，然兩弦時多寡不一，即《授時》亦言朔望外，平行數不定，明其理未著其法。今於加減外，再用一加減，名為二三均數。二曰緯度不能定於五度，時多時寡。古今曆家以交食分數及交泛等，測量定黃白二道相距約五度。然朔望外兩道距度，有損有益，大距計五度三公度之一。若一月有兩食，其弦時用儀求距黃道度五度，未能合天。三曰交行有損益分。蓋羅喉、計都即正交、中交行度，古今為平行。今細測之，月有時在交上，以平求之，必不合算。因設一加減，為交行均數。四曰天行無紫氣。舊謂生於閏餘，又為木之餘氣。今細考諸曜，無象可明，知為妄增。
　　交食之議四：一曰日月景徑分恆不一。蓋日月時行最高，有時行最高，有時行最卑，因相距有遠近，見有大小。又因遠近竿太陰過景，時有厚薄，所以徑分不能為一。二曰日食午正非中限，乃以黃道九十度限為中限。蓋南北東西差俱依黃道，則時差安得不從黃道道論其初末以求中限乎？且黃道出地平上，兩象限自有其高，亦自有其中。此理未明，或宜加反減，宜減反加，凡加進不合者由此也。三曰日食初虧復圓，時刻多寡恆不等，非二時折半之說。蓋視差能變實行為視行，則以視差較食甚前後，鮮有不參差者。夫視差既食甚前後不一，又安能令視行前後一乎？今以視行推變時刻，則初虧復圓，其不能相等也明矣。四曰諸方各依地經推算時刻及日食分。蓋地面上東西見日月出沒，各有前後不同即所得時刻亦不同。故見食雖一而時刻異，此日月食皆一理。若日食則因視差隨地不一，即太陰視距不一，所見食分亦異焉。
　　五緯之議三：一曰五星應用太陽視行，不得以段目定之。蓋五星皆以太陽為主，與太陽合則疾行，沖則退行。且太陽之行有遲疾，則五星合伏日數，時寡時多，自不可以段目定其度分。二曰五星應加緯行。蓋五星出入黃道，各有定距度。又木、土、火三星沖太陽緯大，合太陽緯小。金、水二星順伏緯小，逆伏緯大。三曰測五星，當用恆星為準則。蓋測星用黃道儀外，宜用弧矢等儀。以所測緯星視距二恆星若干度分，依法布算，方得本星真經緯度分。或繪圖亦可免算。
　　是時新法書器俱完，屢測交食淩犯俱密合，但魏文魁等多方陰撓，內官實左右之。以故帝意不能決，諭天經同監局虛心詳究，務祈書一。是年，天經推水星伏見及木星所在之度，皆與《大統》各殊，而新法為合。又推八月二十七日寅正二刻，木、火、月三曜同在張六度，而《大統》推木在張四度，火、月張三度。至期，果同在張六度。九年正月十五日辛酉，曉望月食。天經及《大統》、《回回》、東局，各頂推虧圓食甚分秒時刻。天經恐至期雲掩難見，乃按裡差，推河南、山西所見時刻，奏遣官分行測驗。其日，天經與羅雅谷、湯若望、大理評事王應遴、禮臣李焻及監局守登、文魁等赴臺測驗，惟天經所推獨合。已而，河南所報盡合原推，山西則食時雲掩無從考驗。
　　帝以測驗月食，新法為近，但十五日雨水，而天經以十三日為雨水，令再奏明。天經覆言：
　　諭節氣有二法：一為平節氣，一為定節氣。平節氣者，以一歲之實，二十四平分之，每得一十五日有奇，為一節氣。故從歲前冬至起算，必越六十日八十七刻有奇為雨水。舊法所推十五日子正一刻者此也，定節氣者，以三百六十為周天度，而亦以二十四平分之，每得一十五度為一節氣。從歲前冬至起算，曆五十九日二刻有奇，而太陽行滿六十度為雨水。新法所推十三日卯初二刻八分者此也。太陽之行胡盈有縮，非用法加減之，必不合天，安得平分歲實為節氣乎？以春分症之，其理更明。分者，黃赤相交之點，太陽行至此，乃晝夜平分。舊法於二月十四日下，注晝五十刻、夜五十刻是也。夫十四日書夜已平分，則新法推十四日春分者為合天，而舊法推十六日者，後天二日矣。知春分，則秋分及各節氣可知，而無疑於雨水矣。
　　已而天經於春分屈期，每午赴臺測午正太陽高度。二月十四日高五十度八分，十五日高五十度三十分。末經乃言：
　　京師北極出地三十九度五十五分，則赤道應高五十度五分，春分日太陽正當赤道上，其午正高度與赤道高度等，過此則太陽高度必漸多，今置十四日所測高度，加以地半經差二分，較赤道已多五分。蓋原推春分在卯正二五分弱，是時每日緯行二十四分弱，時差二十一刻五分，則緯行應加五分強。至十五日，並地半徑較赤道高度已多至三十分，況十六日乎？是春分當在十四，不當在十六也。秋風京然。又出《節氣圖》曰：
　　內規分三百六十五度四分度之一者，日度也。外規公三百六十度者，天度也。自冬至起算，越九十一日三十一刻六分，而始曆春分者，日為之限敢，乃在天則已逾二度餘矣。又越二百七十三日九十三刻，一十九分，而即交秋分者，亦日為之限也，乃在天不及二度餘。豈非舊法春分每後天二日，秋分先天二日耶？
　　十年正月辛丑朔，日食，天經等預推京師師見食一分一十秒，應天及各省分秒各殊，惟雲南、太原則不見食。其初虧、食甚、復圓時刻亦各異。《大統》推食一分六十三秒，《回回》推食三分七十秒，東局所推止遊氣侵光三十餘秒。而食時推驗，惟天經為密。時將廢《大統》，用新法，於上管理另局曆務代州知州郭正中言：「中曆必不可盡廢，西曆必不可專行。四曆各有短長，當參合諸家，兼收西法。」十一年正月，乃詔仍行《大統曆》，如交食經緯，晦朔弦望，因年遠有差者，旁求參考新法與回回科並存。上年，進天經光祿寺卿，仍管曆務，十四年十二月，天經言：「《大統》置閏，但論月無中氣，新法尤視合朔後先。今所進十五年新曆，其十月、十二月中氣，適交次月合朔時刻之前，所以月內雖無中氣，而實非閏月。蓋氣在朔前，則此氣尚屬前月之晦也。至十六年第二月止有驚蟄一節，而春分中氣，交第三月合朔之後，則第二月為閏正月，第三月為第二月無疑。」時帝已深知西法之密。迨十六年三月乙丑朔日食，測又獨驗。八月，詔西法果密，即改為《大統曆法》，通行天下。未幾國變，竟未施行。本朝用為憲曆。
　　按明制，曆官皆世業，成、弘間尚能建修改之議，萬曆以後則皆專己守殘而已。其非曆官而知曆者，鄭世子而外，唐順之、周述學、陳壤、袁黃、雷宗皆有著述。唐順之未有成書，其議論散見周述學之《曆宗通議》、《曆宗中經》。袁黃著《曆法新書》，其天地人三元，則本之陳壤。而雷宗亦著《合壁連珠曆法》皆會通回回曆以入《授時》，雖不能如鄭世子之精微，其於中西曆理，亦有所發明。邢雲路《古今律曆考》，或言本出魏文魁手，文魁學本慮淺，無怪其所疏《授時》，皆不得其旨也。
　　西洋人之來中土者，皆自稱甌羅巴人。其曆法與回回同，而加精密。嘗考前代，遠國之人言曆法者多在西域，而東南北無聞。唐之《九執律》，元之《萬年曆》，及洪武間所譯《回回曆》，皆西域也。蓋堯命義、和仲叔分宅四方，義仲、義叔、和叔則以隅夷、南交、朔方為限，獨和仲但曰：「宅西」，而不限以地，豈非當時聲教之西被者遠哉。至於週末，疇人子弟分散。西域、天方諸國，接壤西陲，百若東南有大海之阻，又無極北嚴寒之畏，則抱書器而西征，勢固便也。甌羅巴在回回西，其風俗相類，而好奇喜新競勝之習過之。故則曆法與回回同源，而世世增修，遂非回回所及，亦其好勝之慾為之也。義、和既失其守，古籍之可見者，僅有《周髀》範圍，亦可知其源流之所自矣。夫旁搜採以續千百年之墜緒，亦禮秀求野之意也，故備論也。
