○平北漢
太祖建隆元年夏四月，北漢主劉鈞自將兵至潞州赴李筠。筠兵敗，北漢主懼，引師歸。
九月，昭義節度使李繼勳焚北漢平遙縣，俘獲甚衆。晉州鈐轄荊罕儒復率衆攻汾州，爲北漢大將郝貴超所襲，戰死。罕儒驍將，帝痛惜之，斬其部將不用命者二十餘人。
三年二月，北漢侵潞、晉，守將擊走之。
乾德元年秋七月，漢宿衛殿直王隱、劉昭、趙巒等謀逆，伏誅。辭連其樞密使段常，北漢主出常爲汾州刺史，尋縊殺之。初，北漢主寵姬郭氏，醫僧之女也，僧與嫠婦通而生姬，有殊色。北漢主嬖之，將立爲妃，常以所出非偶，恐貽笑鄰國，北漢主乃止。姬之昆弟姻戚又多抑而不用，故鹹怨常，因譖殺之。死非其罪，國人憐之。
八月，王全斌攻取北漢樂平，詔以爲平晉軍。契丹救之，不及。
九月，北漢以契丹攻平晉軍，洺州防禦使充西山巡檢郭進救卻之。進御下嚴毅，帝遣戍卒，必諭之曰：「汝輩謹奉法。我猶貸汝，郭進殺汝矣。」嘗有軍校自西山詣汴，誣訟進不法事。帝詰知其情，送進，令殺之。會北漢來侵，進語其人曰：「汝敢論我，信有膽氣。今貰汝罪，汝能掩殺敵兵，當即薦汝。如敗，可自投河東。」其人踴躍赴戰，大致克捷。進即以聞，乞還其職，帝從之。
北漢主自潞州之敗，日懼宋師至，以趙文度爲相，又召抱腹山人郭無爲及五臺山僧繼顒參預國事。未幾，文度、無爲議論不協，北漢主出文度守汾州，而無爲獨相，機事悉以委之。
契丹主以書貽北漢主曰：「爾不稟我命，擅改年號，助李筠，殺段常，其罪有三。」北漢主引「父爲子隱。」謝之。初，北漢與契丹歲使不絕，自是契丹使不來，而北漢使往則見留，羣臣悉以使北爲懼。北漢主乃命從子侍衛親軍使繼文請命，亦被拘。繼文，崇之嫡孫，魁梧有氣局，沈毅寡言，契丹主亦厚禮之。
二年二月，昭義節度使李繼勳侵北漢遼州，克之。初，繼勳屢敗北漢兵，至是，帝遣曹彬會繼勳合兵入北漢境，攻其邊邑及遼、石州。繼勳大敗北漢兵於遼城下。北漢遼城刺史杜延韜危蹙，籍部下兵三千人降於繼勳。契丹以六萬騎來援，又擊走之。
三月，北漢耀州團練使周審玉等來降。四年，北漢復取遼州。五年，北漢將閻章、樊暉各以砦來降。
開寶元年秋七月，北漢主鈞殂，養子繼恩立。初，世祖女適薛釗，生繼恩。再適何氏，生繼元。二子初幼孤，世祖以鈞無子，命養爲子。鈞嘗謂郭無爲曰：「繼恩巽輭，非濟世材，恐不能了我家事，將奈何？」無爲不對。至是，病篤，召無爲付以後事。繼恩既嗣位，怨無爲初不助己，且恐其專政，加守司空，外示優禮，內實疏之。
八月戊辰，遣李繼勳將兵伐北漢。初，帝嘗因諜者謂漢主曰：「君家與周世讎，宜不屈。今我與爾無所間，何爲困此一方人也。若有志中國，宜下太行以決勝負。」漢主遣諜者報曰：「河東土地甲兵不足以當中國，然我家世非叛者，區區守此，蓋懼漢氏之不血食也。」帝哀其言，謂諜者曰：「爲我語鈞，開爾一生路。」故終鈞世不加兵。至是，聞其卒，遣李繼勳等以禁軍伐之。
北漢主初立，宋兵已入其境，乃遣劉繼業、馬峯等領軍扼團柏谷。峯至銅鍋河，李繼勳前鋒將何繼筠擊破之，斬首三千餘級，遂奪汾河橋，薄太原城下，焚延夏門。
九月，北漢主欲逐郭無爲，畏懦不能決。月餘，供奉官侯霸榮率十餘人，挺刃入閣，反扃其門。時繼恩獨處喪次，見之驚起，繞屏還走，霸榮以刃揕其胸，殺之。無爲使人梯屋入，殺霸榮。繼恩立才六十餘日，並人疑無爲授意於霸榮，亟殺之以滅口。無爲與羣臣議立繼恩之弟繼元，參議中書事張昭敏獨曰：「少主非劉氏，故嗣位不終。今宜立宗姓，以慰民望。世祖嫡孫繼文，久留契丹，歷險阻，宜迎立之，可以固宗社，結敵援。」無爲不從，以繼元易制，遂立之。
十一月，北漢主遣使告即位於契丹，且乞師。契丹主遣撻烈將諸道兵救之。帝亦遣使齎詔諭北漢主令降，約以平盧節度使授之。又別賜郭無爲詔，許以邢州節度使。無爲得詔色動，勸北漢主納款，北漢主不從。初，帝使諜者惠璘僞稱殿前指揮使，負罪奔北漢，無爲知其謀，使爲供奉官。及宋兵入境，璘即奔赴，至嵐谷，候吏獲送太原，北漢主使無爲鞫之，無爲釋不問。有李超者，知璘奸狀，上告，無爲怒，並超斬之以絕口。李繼勳等聞契丹兵來，皆引歸，北漢因大掠晉、絳二州。
北漢主繼元妻段氏常以小過爲孝和後郭氏所責，既而病卒。繼元疑後殺之，後方縗服哭孝和帝於柩前，繼元遣其嬖臣範超執而縊殺之。宮中嬪御遭罹逼辱，無復嫌間。世祖十子，鎬、錡、錫最有賢行，繼元聽羣小之譖，幽囚之，未逾年皆死。
二年三月，帝以李繼勳等師還無功，謀再舉，以問魏仁浦曰：「朕欲親征太原，何如。」仁浦曰：「欲速則不達，惟陛下重之。」帝不聽，命繼勳等將兵先赴太原，以光義爲東京留守，自將發汴。三月，至太原。築長連城圍之，立砦於城四面：繼勳軍於南，趙贊軍於西，曹彬軍於北，党進軍於東。北漢劉繼業等乘晦突門，犯東、西砦，戰敗而遁。帝又命壅汾、晉二水以灌城，漢人大恐。郭無爲復勸北漢主出降，漢主不從。一日，因宴羣臣，無爲痛哭於庭曰：「奈何以空城抗宋百萬之師乎？」引佩刀欲自刺，冀動衆心。漢主遽降階執其手，引升坐而止。
夏四月，契丹復救北漢，帝度其必由鎮、定救太原，使韓重贇倍道兼行赴之。又聞其分道，一自石嶺關入，召何繼筠逆擊，授以方略。繼筠遇契丹兵於陽曲，大敗之，斬首千餘級。重贇亦先陣於嘉山，契丹兵自定州西入，見旗幟，大駭欲遁，重贇急擊，大破之，擒其首領三十餘人。帝命以所獲契丹俘示於城下，城中喪氣。憲州判官史昭文、嵐州刺史趙文度各以城降。
閏五月壬子，帝班師。時，契丹主遣韓知璠冊立北漢主。知璠習知戎備，在圍城中，晝夜督察，盡心固守。帝命水軍載弩環攻，驍將石漢卿等多戰死，北漢兵亦屢敗。夜半，忽傳呼「漢主出降。」帝將開壁門，將作使趙璲曰：「受降如受敵，詎可中夜輕出。」已而果諜者。契丹復遣南大王者將兵援北漢，東西班都指揮使李懷忠曰：「敵勢已困，若選勁兵急攻，破在旦夕。」都虞候趙廷翰請先登，帝壯之，俾率衆攻城。戰不利，懷忠中流矢幾死。時帝師頓於甘草地，會暑雨，軍士多疾，太常博士李光贊上書請班師。帝以問趙普，普亦以爲然。乃分兵屯鎮、潞，徙北漢民萬餘戶于山東、河南而還。北漢主籍宋所棄軍儲，得粟三萬，茶、絹各數萬，喪敗之餘，賴此少濟。
太原之圍，南城爲汾水所陷。郭無爲謀出降，因請自將夜擊宋。北漢主信之，選精甲千人付無爲，自登延夏門送之。無爲行至北橋，值風雨晦冥而止。至是，閹人衛德貴告其事，且言無爲獻地之謀，蹤跡屢露，反狀明白，不可赦。北漢主乃殺之以徇。
三年春正月，契丹韓知璠自太原歸，言晉陽多梗而劉繼元無輔。政事令高勳亦言：「我與晉陽，父子之國，先君以一怒而盡拘其使，甚無謂也。」契丹主乃盡索北漢使者，凡十六人，厚禮而遣之。仍命劉繼文爲平章事，李弼爲樞密使，俾輔繼元。繼文等久留契丹，復受其命歸秉國政，左右皆譖毀之，北漢主乃出繼文爲代州刺史，李弼爲憲州刺史。
是年，北漢主以僧繼顒爲太師兼中書令。繼顒本劉氏孽子，以宗姓授鴻臚卿，嘗遊華嚴，見地有寶氣，乃於團柏谷置銀場，募民鑿山，官收十之四，繼顒自督，所獲即倍於民。時，北漢主多內寵，繼顒獻首飾數百副，北漢主大喜，遂有是命。
六年十二月，北漢主殺其弟劉繼欽。初，北漢主爲大內都點檢，父鈞以其幼弱，命劉繼欽副之，委以禁衛。北漢主立，親舊多所誅放，繼欽遂謝病請罷。北漢主曰：「繼欽但事先帝，豈肯爲我盡力耶？」乃黜居交城，尋遣人殺之。北漢主性殘忍，凡臣下有忤意，必族其家。自帝親征及遣將攻伐，因之殺傷不可勝計，大將張崇訓、鄭進、衛儔、故相張昭敏、樞密使高仲曦等，先後俱以讒見殺。
九年八月，帝令党進、潘美、楊光美、牛思進、米文義率兵分五道以攻太原，又遣郭進等分攻忻、代、汾、沁、遼、石等州。諸將所向克捷，進敗北漢兵於太原城。北漢主急求救於契丹，契丹主遣其相耶律舒救之。師還。先是，帝嘗微行過趙普，與普謀下漢。普曰：「太原當西、北二面，太原既下，則二邊之患我獨當之。不如姑俟削平諸國，則彈丸黑子之地將安逃乎？」帝以爲然，故雖連年攻伐，至城下，輒退師。
太宗太平興國四年春正月庚寅，帝議伐漢，薛居正等多以爲不可，惟曹彬力贊之，帝意遂決。乃以潘美爲北路都招討使，帥崔彥進、李漢瓊、劉遇、曹翰、米信、田重進軍，分四面攻太原城。又以郭進爲太原石嶺關都部署，以斷燕、薊援師。
二月甲子，帝自將伐漢。
三月乙未，漢求救於契丹，契丹遣耶律舒爲都統，敵烈爲監軍，帥師赴之。至白馬嶺，與都部署郭進遇。舒欲阻澗以待後軍，敵烈不從，渡澗迎戰，未成列，進薄之，契丹大敗，敵烈等皆死。會耶律斜軫兵至，進引師退，沙得免。田欽祚護石嶺屯軍，恣爲奸利，進不能禁，屢形於言，欽祚憾之。進武人，剛烈，戰功高，欽祚數加凌侮，進不能堪，遂縊而死。欽祚以卒中風眩聞。帝悼惜良久，贈安國節度使。左右皆知而無敢言者。尋詔以牛思進代之。
夏四月，帝發鎮州。行營都監折御卿分兵攻岢嵐軍，下之，遂取嵐州。漢人於隆州依險築城以拒，帝遣軍使解暉、折彥贇等先發兵圍之，繼遣尹勳往，城遂陷。
庚午，帝次太原。時潘美等屢敗漢兵，進築長連城圍太原，矢石交下如雨。漢外援不至，餉道又絕，城中大懼。帝至，督戰益急，城無完堞。帝慮城陷殺傷者衆，詔諭繼元降。使者至城，守陴者不納。帝親督諸將士進薄城下，列陣於前，蹲甲交射，矢集城上如蝟毛。
五月，漢指揮使郭萬超逾城出降，繼元親信之臣多亡，城中危急。帝復詔諭繼元速降，當保終始富貴。詔雖入城，而諸將銳攻不可遏。帝猶慮城陷害良民，麾兵少卻。甲申，繼元乃夜遣客省使李勳奉表乞降。詔許之，因至城北，張樂宴從臣於城臺。明日，繼元率官屬縞衣、紗帽待罪臺下。帝釋之，賜襲衣、玉帶，召使升臺。繼元叩首謝罪，詔授特進、檢校太師、右衛上將軍，封彭城郡公，賜賚甚厚。命劉保勳知太原府。凡得州十、軍一、縣四十一。帝作《平晉詩》，命從臣和。又授漢相李惲以下官有差。詔毀太原舊城，改爲平晉縣，以榆次縣爲幷州。遣使分部徙太原民居之。縱火焚太原廬舍，老幼趨城門不及，焚死者甚衆。
陳邦瞻曰：宋之受制夷狄，由失燕、薊。其不能取燕、薊，失在先下太原。昔王樸與周世宗謀取天下，欲先定南方，次及燕，最後乃及太原。蓋燕定則太原直置中兔耳，將安往哉。太祖、趙普雪夜之言，亦樸遺意也。太宗一日忘其本謀，急於伐漢，盡銳堅城之下，僅能克之。師已老矣，復議攻燕，所謂強弩之末，勢不能穿魯繒。一敗而沒世不振，再舉再失利，皆由太宗不知天下之大勢，倒行求前，以致顛蹶也。
