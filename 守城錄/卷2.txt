
　　城門舊制，門外築瓮城，瓮城上皆敵樓，費用極多。以禦尋常盜賊，則可以遮隔箭叢；若遇敵人大炮，則不可用。須是除去瓮城，止於城門前離城五丈以來，橫築護門墻，使外不得見城門啟閉，不敢輕視，萬一敵人奔衝，則城上以炮石向下臨之。更於城門裡兩邊各離城二丈，築牆丈五六十步，使外人乍入，不知城門所在，不可窺測；縱使奔突入城，亦是自投陷阱。故城門不可依舊制也。
　　護門墻，只於城門十步內橫築高厚墻一堵。亦設鵲台，高二丈。墻在鵲台上，高一丈三尺，腳厚八尺，上收三尺，兩頭遮過門三二丈，所以遮隔衝突。門之啟閉，外不得知；縱使突入墻內，城上炮石雨下，兩邊羊馬墻內可以夾擊。
　　城門貴多不貴少，貴開不貴閉。城門既多且開，稍得便利去處，即出兵擊之。夜則斫其營寨，使之晝夜不得安息，自然不敢近城立寨。又須為牽制之計，常使彼勞我逸。又於大城多設暗門，羊馬城多開門竇，填壕作路，以為突門。大抵守城常為戰備，有便利則急擊之。
　　城門舊制皆有門樓，別無機械，不可禦敵。須是兩層，上層施勁弓弩，可以射遠；下層施刀槍。又為暗板，有急則揭去，注巨木石以碎攻門者。門為三重，卻厚一門，如常制，比舊加厚；次外一重門，以徑四五尺堅石，圓木鑿眼貫串以代板，不必用鐵葉釘裹；又外一重，以木為柵，施於護門墻之兩邊。比之一樓一門，大段濟事。
　　城門外壕上，舊制多設釣橋，本以防備奔衝，遇有寇至，拽啟釣橋，攻者不可越壕而來。殊不知正礙城內出兵。若放下釣橋，然後出兵，則城外必須先見，得以為備；若兵已出復拽起橋板，則緩急難於退卻，苟為敵所逼逐，往往溺於壕中。此釣橋有害無益明矣。止可先於門前施機械，使敵必不能入。拆去釣橋，只用實橋，城內軍馬進退皆便；外人皆懼城內出兵，晝夜不敢自安。
　　干戈板，舊制用鐵葉釘裹，置於城門之前，城上用轆轤車放，亦是防遏衝突。其礙城內出兵，則與釣橋無異。既於城門裡外安置機械，自可不用干戈板，以為出兵快便之利。
　　城身，舊制多是四方，攻城者往往先務攻角，以其易為力也。城腳上皆有敵樓、戰棚，蓋是先為堤備。苟不改更，攻城者終是得利。且以城之東南角言之，若直是東南角攻，則無足畏。炮石力小，則為敵樓、戰棚所隔；炮石力大，則必過入城裡。若攻城人於城東立炮，則城上東西數十步，人必不能立；又於城南添一炮，則城上南北數十步，人亦不能立，便可進上城之具。此城角不可依舊制也。須是將城角少縮向裡。若攻東城，即便近北立炮；若攻南城，則須近西立炮，城上皆可用炮倒擊其後。若正東南角立炮，則城上無敵樓、戰棚，不可下手。將城角縮向裡為利，甚不可忽也！
　　女頭墻，舊制於城外邊約地六尺一個，高者不過五尺，作「山」字樣。兩女頭間留女口一個。女頭立狗腳木一條，掛搭皮、竹篦籬牌一片，遮隔矢石，若禦大炮，全不濟事。又女頭低小，城外箭叢可中守禦人頭面。須是於城上先築鵲台，高二丈，闊五尺。鵲台上再築牆，高六尺，厚二尺。自鵲台向上一尺五寸，留方眼一個，眼闊一尺，高八寸。相離三尺，又置一個。兩眼之間，向上一尺，又置一個，狀如「品」字。向上作平頭墻。敵上登城，只於方眼中施槍刀，自可刺下。方眼向下，自有平頭墻，即是常用篦籬牌掛搭，不必臨時施設也。更於鵲台上靠墻，每相去四寸，立排叉木一條，高出女墻五尺，橫用細木夾勒兩道或三道。攻城者或能過「品」字眼，亦不能到平頭墻上。更兼墻上又有排叉木限隔，若要越過排叉木，必須用手攀援，則刀斧斫之，槍刃刺之，無不顛朴。守者用力甚少，攻者必不得志也。
　　馬面，舊制六十步立一座，跳出城外不減二丈，闊狹隨地利不定，兩邊直覷城腳。其上皆有樓子，所用木植甚多，若要畢備，須用氈皮掛搭，然不能遮隔大炮，一為所擊，無不倒者。樓子既倒，守禦人便不得安。或謂須預備樓子，隨即架立。是未嘗經歷攻守者之言也。樓子既倒，敵必以炮石弓弩並力臨城，則損害人命至多，亦不可架立。今但只於馬面上築高厚墻，中留「品」字空眼，以備覘望，又可通過槍刀；靠城身兩邊開兩小門，下看城外，可施禦捍之具。墻裡造瓦廈屋，與守禦人避風雨，遇有攻擊，便拆去瓦廈屋。靠墻立高大排叉木，用粗繩橫編，若造笆相似。任其攻擊，必不能為害。
　　城不必太高，太高則積雨摧塌，修築費力。城面不可太闊，太闊則炮石落在城上，緩急擊中守禦人。城面通鵲台只可一丈五尺或一丈六尺，高可三丈或三丈五尺。沿邊大郡城壁，高亦不過五丈，闊不過二丈而已。
　　羊馬墻，舊制州郡或無之，其有者，亦皆低薄，高不過六尺，厚不過三尺，去城遠近，各不相同，全不可用。蓋羊馬城之名，本防寇賊逼逐人民入城，權暫安泊羊馬而已，故皆不以為意，然捍禦寇攘，為力甚薄。當於大城之外，城壕之裡，去城三丈，築鵲台，高二尺，闊四尺。台上築墻，高八尺，腳厚五尺，上收三尺。每一丈留空眼一個，以備覘望。遇有緩急，即出兵在羊馬墻裡作伏兵，正是披城下寨，仍不妨安泊羊馬。不可去城太遠，太遠則大城上拋磚不能過，太近則不可運轉長槍。大凡攻城，須填平壕，方可到羊馬墻下。使其攻破羊馬墻，亦難為入，入亦不能駐足。攻者止能於所填壕上一路直進，守者可於羊馬墻內兩下夾擊，又大城上磚石如雨下擊，則是一面攻城，三面受敵，城內又有一小炮可施。凡攻城器械，皆不可直抵城腳。攻計百出，皆有以備之也。
　　羊馬墻內，須酌量地步遠近，安排叉木，作排叉門；分佈安排人兵，易於點檢，兼防奸細入城。
　　城郭，舊制只是一重，城外有壕，或有低薄羊馬城者。使善守者守之，雖遇大敵，攻計百出，亦可退卻。或不經歷攻守者，忽遇大敵圍城，無不畏怯，須是先為堤備。當於外壕裡修築高厚羊馬墻，與大城兩頭相副，即是一壕兩城。更於大城裡開掘深闊裡壕，上又築月城，即是兩壕三城。使攻城者皆是能者，亦無可攻之理。大抵城與壕水，一重難攻於一重。至若裡城裡壕，則必不可犯。計羊馬墻與裡城、裡壕之費，亦不甚多。若為永久之計，實不可缺。
　　修築裡城，只於裡壕垠上，增築高二丈以上，上設護險墻。下臨裡壕，須闊五丈、深二丈以上。攻城者或能上大城，則有裡壕阻隔，便能使過裡壕，則裡城亦不可上。若此則不特可禦外敵，亦可潛消內患。裡城、裡壕，費用不多，不可不設，庶免臨急旋開築也。
　　修城，舊制多於城外腳下，或臨壕栽了叉木，名為鹿角，大為無益。若城中人出至鹿角內，壕外人施放弓弩，鹿角不能遮隔。若乘風用火，可以燒毀。不如除去為便也。
　　今來修城制度，止是在外州郡城池。若非京都會府，須於城內向裡，量度遠近，再於外修築一重，其外安置營寨；向裡更築一重，作官府。若此，豈特堅固而已哉；內外之患，無不革盡。
　　攻城用雲梯，是欲蟻附登城。今女頭上既留「品」字眼，又有排叉木，又有羊馬墻，重重限隔，則雲梯雖多，無足畏也。
　　攻城用洞子，止是遮隔城上箭叢，欲以搬運土木磚石，填壘壕塹，待其填平，方進攻具；或欲逼城挖掘。今既有羊馬墻為之限隔，則洞子亦自難用。
　　對樓則與城上樓子高下相對。鵝車稍高，向前瞰城頭，向下附城腳。天橋與對樓無異，止是於樓上用長板作腳道，或摺疊翻在城上。皆是登城之具。今羊馬墻既有人守，自可兩邊橫施器刃。敵人別用撞竿，與其他應急機械，自不足畏。大凡攻城用天橋、鵝車、對樓、火車、火箭，皆欲人驚畏，有以備之，則不能害。
　　攻城多填幔道，有至三數條者，高與城等，直逼城頭。今羊馬墻中既有人拒敵，又大城上拋擲磚石，自然難近大城。更照所填幔道，於城內靠城腳急開裡壕，垠上更築月城，兩邊栽立排叉木。大城上又起木棚，置人於棚上。又於欲來路上，多設簽刺。使能登城，亦不能入城；或能入城，亦不能過裡壕；縱過裡壕，絕不能過月城。以幔道攻城者，百無一二。今所備如此，亦何足畏！凡攻城者有一策，則以數策應之。
　　攻城用大炮，有重百斤以上者，若用舊制樓櫓，無有不被摧毀者。今不用樓子，則大炮已無所施。兼城身與女頭皆厚實，城外炮來，力大則自城頭上過，但令守禦人靠墻坐立，自然不能害人；力小則為墻所隔。更於城裡亦用大炮與之相對施放，兼用遠炮，可及三百五十步外者，以害用事首領。蓋攻城必以驅擄脅從者在前，首領及同惡者在後。城內放炮，在城上人照料偏正遠近，自可取的。萬一敵炮不攻馬面，只攻女頭，急於女頭墻裡栽埋排叉木，亦用大繩實編，如笆相似，向裡用斜木柱搶，炮石雖多，亦難擊壞。炮既不能害人，天橋、對樓、鵝車、幔道之類，又皆有以備之，則人心安固，城無可破之理。
　　攻守利器，皆莫如炮。攻者得用炮之術，則城無不拔；守者得用炮之術，則可以制敵。守城之炮，不可安在城上，只於城裡量遠近安頓；城外不可得見，可以取的。每炮於城立一人，專照斜直遠近，令炮手定放。小偏則移定炮人腳，太偏則移動炮架；太遠則減拽炮人，太近則添拽炮人。三兩炮間，便可中物。更在炮手出入腳步，以大炮施小炮三及三百步外。若欲摧毀攻具，須用大炮；若欲害用事首領及搬運人，須用遠炮。炮不厭多備。若用炮得術，城可必固。其於製造炮架精巧處，又在守城人工匠臨時增減。
　　用炮摧毀攻具，須用重百斤以上或五七十斤大炮。若欲放遠，須用小炮。只黃泥為團。每個乾重五斤，輕重一般，則打物有準，圓則可以放遠。又泥團到地便碎，不為敵人復放入城，兼亦易辦。雖是泥團，若中人頭面胸臆，無不死者；中人手足，無不折跌也。
　　城被圍閉，城內務要安靜。若城外有人攻擊，城內驚擾，種種不便。須是將城內地步，分定界分，差人巡視。遇有人逼城，號令街巷，不得往來。非籍定系上城守禦及策應人，不得輒上城；在城上人，不得輒下城。過當防閑，不特可免驚惶，亦可杜絕不虞。
